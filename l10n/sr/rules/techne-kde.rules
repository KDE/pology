# The arcane for KDE translation into Serbian.
# Chusslove Illich (Часлав Илић) <caslav.ilic@gmx.net>
# License: GPLv3

environment kde

# ----------------------------------------
# Detect Latin segments outside of allowed contexts.

clearFilters
# No filters (e.g. markup designates allowed contexts).

# Allow original UI references (autoresolved when summit is scattered).
*hook name="sr:checks/naked_latin_origui" on="msgstr"
id="x-latin"
hint="латиница ван дозвољеног контекста"

# ----------------------------------------
# Detect markup errors.

clearFilters

# Convert to ordinary special entities  which are auto-generated
# when KDE summits are scattered.
addFilterRegex match="(&\S+?)(?:_ot_sp|_ot|_sp|_db41)(-\S*;)" repl="\1\2" \
               on="pmsgstr"

# Strict mode means to request valid translation even if the original is not.
# Catalogs must announce markup in the header, using markup type keyword in
# X-Text-Markup field (see markup= parameters in factories below);
# when the hook and catalog markup types do not match, the check is skipped.
# To check custom entities resolved when KDE summits are scattered,
# environment variable ENTDEFS_KDE4_SR must provide directory paths of
# entity definitions (*.entities files); these can be found in KDE repository,
# trunk/l10n-support/sr/entities/.

# ...in KDE4 UI POs.
*hook name="check-markup/check-xml-kde4-sp" \
      factory="strict=True, entpathenv='ENTDEFS_KDE4_SR', fcap=True, \
               mkeyw='kde4'" \
      on="msgstr"
id="x-markup-k"
hint="грешке у обележавању"

# ...in pure Qt UI POs.
*hook name="check-markup/check-xml-qtrich-sp" \
      factory="strict=True, entpathenv='ENTDEFS_KDE4_SR', fcap=True, \
               mkeyw='qtrich'" \
      on="msgstr"
id="x-markup-q"
hint="грешке у обележавању"

# ...in KDE documentation POs.
*hook name="check-markup/check-xml-docbook4-sp" \
      factory="strict=True, entpathenv='ENTDEFS_KDE4_SR', fcap=True, \
               mkeyw='docbook4'" \
      on="msgstr"
# Remove entities used as-is KDE documentation.
addFilterRegex match="&\S+\.\S+\.mail;" on="pmsgid,pmsgstr"
addFilterRegex match="&\S+\.\S+\.documentation;" on="pmsgid,pmsgstr"
addFilterRegex match="&under(FDL|GPL);" on="pmsgid,pmsgstr"
addFilterRegex match="&kde-(ftp|http);" on="pmsgid,pmsgstr"
id="x-markup-db"
hint="грешке у обележавању"

# ----------------------------------------
# Detect problems with UI references.

clearFilters
# No filters (e.g. markup designates references automatically).

# ...in KDE4 UI POs.
*hook name="ui-references/check-ui-kde4" \
      factory="uicpathenv='UICATS_KDE4_SR', mkeyw='kde4'" \
      on="msgstr"
id="x-uiref-k"
hint="неуспело разрешавање ниске сучеља"

# ...in KDE documentation POs.
*hook name="ui-references/check-ui-docbook4" \
      factory="uicpathenv='UICATS_KDE4_SR', mkeyw='docbook4'" \
      on="msgstr"
id="x-uiref-db"
hint="неуспело разрешавање ниске сучеља"

# ...in other catalogs (e.g. pure Qt UI, desktop files).
*hook name="ui-references/check-ui" \
      factory="uicpathenv='UICATS_KDE4_SR', \
               mkeyw=['docbook4', 'kde4'], invmkeyw=True" \
      on="msgstr"
id="x-uiref-o"
hint="неуспело разрешавање ниске сучеља"

# ----------------------------------------
# The following rules should be applied on pure text.
clearFilters
include file="puretext.filters"

# Check spelling.
*hook name="check-lingo/check-spell-sp" \
      factory="lang='sr', env='kde'" \
      on="msgstr"
# Remove Latin-only words.
addFilterRegex match="[a-zđžćčš]+" on="pmsgid,pmsgstr"
id="x-spell"
hint="непознате или погрешно написане речи"
# Разне транскрипције и измишљотине, прескачемо док нешто не приправимо.
valid cat="timezones4,desktop_l10n,kdelibs_colors4"
valid cat="kdelibs4" ctx="unicode block name"
valid cat="kdelibs4" srcref="kcalendarsystem(hijri|jalali|hebrew)"
valid cat="desktop_kdelibs" srcref="all_languages.desktop"
valid cat="kdeqt" ctx="QFontDatabase"
valid cat="kfontinst" srcref="Unicode(Blocks|Scripts)\.h"
# Елементи транскрипта.
valid span="^(аку)$" after="\$\[[^\]]*"
