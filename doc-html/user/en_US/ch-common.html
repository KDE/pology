<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="HTML Tidy for Linux (vers 25 March 2009), see www.w3.org">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Chapter&nbsp;9.&nbsp;Common Functionality</title>
<link rel="stylesheet" href="data/style.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.75.2">
<link rel="home" href="index.html" title="Pology User Manual">
<link rel="up" href="index.html" title="Pology User Manual">
<link rel="prev" href="ch-lingo.html" title="Chapter&nbsp;8.&nbsp;Language Validation and Derivation">
<link rel="next" href="ch-combined.html" title="Chapter&nbsp;10.&nbsp;Combined Arms Tactics">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr>
<th colspan="3" align="center">Chapter&nbsp;9.&nbsp;Common Functionality</th>
</tr>
<tr>
<td width="20%" align="left"><a accesskey="p" href="ch-lingo.html">Prev</a>&nbsp;</td>
<th width="60%" align="center">&nbsp;</th>
<td width="20%" align="right">&nbsp;<a accesskey="n" href="ch-combined.html">Next</a></td>
</tr>
</table>
<hr></div>
<div class="chapter">
<div class="titlepage">
<div>
<div>
<h2 class="title"><a name="ch-common" id="ch-common"></a>Chapter&nbsp;9.&nbsp;Common Functionality</h2>
</div>
</div>
</div>
<p>Different parts of Pology provide common functionality, such as thematic groups of options to scripts, file selection patterns, reliance on PO metadata, etc. This chapter describes such common functionality.</p>
<div class="sect1">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="sec-cmshellcomp" id="sec-cmshellcomp"></a>9.1.&nbsp;Shell Completion</h2>
</div>
</div>
</div>
<p>Shell completion means that, similarly as for command names, it is possible to contextually complete command parameters by pressing the <span class="keycap"><strong>Tab</strong></span> key. This allows you to efficiently type in the command line, as well as to quickly remind yourself of options and option parameters without resorting to documentation or browsing the file system.</p>
<p>For example, pressing <span class="keycap"><strong>Tab</strong></span> just after <a class="link" href="ch-sieve.html" title="Chapter&nbsp;3.&nbsp;Sieving">the <span class="command"><strong>posieve</strong></span> command</a> will complete sieve names, and <span class="keycap"><strong>Tab</strong></span> after the <code class="option">-s</code> option will complete sieve parameters based on sieves that precede it in the command line. This:</p>
<pre class="programlisting">
$ posieve s&lt;TAB&gt;
</pre>
<p>will show all sieves beginning with <code class="literal">s</code>, and complete the sieve name once sufficient number of characters have been entered to uniquely determine it, while this:</p>
<pre class="programlisting">
$ posieve stats -s m&lt;TAB&gt;
</pre>
<p>will show all parameters to <span class="command"><strong>stats</strong></span> beginning with <code class="literal">m</code>, and complete one of them after few more characters are typed in.</p>
</div>
<div class="sect1">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="sec-cmconfig" id="sec-cmconfig"></a>9.2.&nbsp;User Configuration</h2>
</div>
</div>
</div>
<p>Various parts of Pology can be configured through the configuration file <code class="filename">.pologyrc</code> in the root of user's home directory (<code class="filename">~/.pologyrc</code> for short). The configuration file does not have to exist, so you have to create it when you want to configure something for the first time. It must be UTF-8 encoded.</p>
<p>The configuration file is in the <a class="ulink" href="http://en.wikipedia.org/wiki/INI_file" target="_top">INI</a> format, which is composed of sections beginning with a <code class="literal">[<em class="replaceable"><code>section</code></em>]</code> line, and fields of the form <code class="literal"><em class="replaceable"><code>field</code></em> = <em class="replaceable"><code>value</code></em></code> within a section. Comments can be written after <code class="literal">#</code> character at the beginning of the line. Here is an example of a <code class="filename">~/.pologyrc</code> file:</p>
<pre class="programlisting">
[user]
name = Chusslove Illich
original-name = Часлав Илић
email = caslav.ilic@gmx.net
po-editor = Kate

[enchant]
# Autodetection sufficient.

[posieve]
msgfmt-check = yes
param-ondiff/stats = yes

# Project setups follow.

[project-kde]
language = sr
language-team = Serbian
team-email = kde-i18n-sr@kde.org
plural-forms = nplurals=4; plural=n==1 ? ...
</pre>
<p>This configuration contains four sections: <code class="literal">[user]</code>, <code class="literal">[enchant]</code>, <code class="literal">[posieve]</code>, and <code class="literal">[project-kde]</code>. The <code class="literal">[user]</code> section provides some information on the person who uses Pology. The <code class="literal">[enchant]</code> section configures the Enchant spell checker wrapper, used by Pology for spell checking. The <code class="literal">[posieve]</code> section configures the behavior of the <a class="link" href="ch-sieve.html" title="Chapter&nbsp;3.&nbsp;Sieving"><span class="command"><strong>posieve</strong></span></a> script. The <code class="literal">[project-kde]</code> section provides information on a project that the user contributes translation to.</p>
<p>Some details about the configuration file syntax are as follows. Leading and trailing whitespace in section and field names and values is not significant, e.g. <code class="literal">foo=bar</code> is same as <code class="literal">foo = bar</code>. Percent (%) character is used to expand the value of another field, for example:</p>
<pre class="programlisting">
rootdir = /path/to/somewhere
datadir = %(rootdir)s/data
</pre>
<p>where the <code class="literal">%(...)s</code> is Python's string interpolation syntax. Importantly, when you need a literal % character within a value (such as in <code class="literal">plural-forms</code> field in the previous example), you must repeat it twice, <code class="literal">%%</code>. Switch-type fields (<code class="literal">msgfmt-check</code> in the previous example) can take any of the following values for the two states: <code class="literal">0</code>, <code class="literal">no</code>, <code class="literal">false</code>, or <code class="literal">off</code>; and <code class="literal">1</code>, <code class="literal">yes</code>, <code class="literal">true</code>, or <code class="literal">on</code> (case is not important).</p>
<p>Sections in the configuration can be of one of four general types:</p>
<div class="itemizedlist">
<ul class="itemizedlist" type="disc">
<li class="listitem">
<p>General sections, which provide information used by various parts of Pology as they need them. The <code class="literal">[user]</code> section from the previous example is a general section.</p>
</li>
<li class="listitem">
<p>External tool sections, which are used to configure external libraries and programs used within Pology. The <code class="literal">[enchant]</code> section from the previous example is of this type.</p>
</li>
<li class="listitem">
<p>Internal tool sections, which configure the behavior of Pology's own scripts. This is the <code class="literal">[posieve]</code> section from the previous example.</p>
</li>
<li class="listitem">
<p>Project sections, which provide information related to particular translation projects that the user is contributing to. Names of these sections always start with <code class="literal">project-</code>, such as <code class="literal">[project-kde]</code> from the previous example.</p>
</li>
</ul>
</div>
<p>Internal tool sections are documented together with the respective tools, while sections of other types are described in the following.</p>
<p>When mentioning configuration fields in their documentation and elsewhere, they are referred to as <code class="literal">[<em class="replaceable"><code>section</code></em>]/<em class="replaceable"><code>field</code></em></code>. If there is only a fixed number of possible values to a field, this is denoted as <code class="literal">[<em class="replaceable"><code>section</code></em>]/<em class="replaceable"><code>field</code></em>=[<em class="replaceable"><code>VALUE1</code></em>|<em class="replaceable"><code>VALUE2</code></em>|<em class="replaceable"><code>VALUE3</code></em>|...]</code>; if one of the values is the default, it is prefixed with a star (*).</p>
<div class="sect2">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="sec-cmcfguser" id="sec-cmcfguser"></a>9.2.1.&nbsp;The <code class="literal">[user]</code> section</h3>
</div>
</div>
</div>
<p>Many parts of Pology can take advantage of information about you and the tools you use. This information is given in the <code class="literal">[user]</code> section. For example, when initializing PO file from a template, your name, email address in the PO header can be filled out, or a PO file can be opened in a translation editor that you use (if it is supported).</p>
<p>Known configuration fields are as follows:</p>
<div class="variablelist">
<dl>
<dt><span class="term"><code class="literal">[user]/name</code></span></dt>
<dd>
<p>Your name if it is written in Latin script, or the romanized equivalent of your name. The intention is that it is readable (or semi-readable) to people from various places in the world, who would use it to contact you if necessary.</p>
</dd>
<dt><span class="term"><code class="literal">[user]/original-name</code></span></dt>
<dd>
<p>This is your name in your native language and script, whatever it may be. If it would be the same as the name in the <code class="literal">[user]/name</code> field, setting this field is not necessary.</p>
</dd>
<dt><span class="term"><code class="literal">[user]/email</code></span></dt>
<dd>
<p>Your email address.</p>
</dd>
<dt><span class="term"><code class="literal">[user]/language</code></span></dt>
<dd>
<p>The language code of the language you translate into. If by any chance you translate into several languages, this field can be overridden in per-project configuration sections.</p>
</dd>
<dt><span class="term"><code class="literal">[user]/encoding</code></span></dt>
<dd>
<p>The encoding of the PO files you work on. Nowdays this should really, really be UTF-8. If it is not UTF-8 for everything that you work on, you can override it in per-project configuration sections.</p>
</dd>
<dt><span class="term"><code class="literal">[user]/plural-forms</code></span></dt>
<dd>
<p>The value for the <a class="link" href="ch-poformat.html#sec-poplurals" title="2.4.&nbsp;Plural Forms"><code class="literal">Plural-Forms</code> PO header field</a> used for your language. If it differs between projects, you can override the value set here in per-project configuration sections.</p>
</dd>
<dt><span class="term"><code class="literal">[user]/po-editor</code></span></dt>
<dd>
<p>The human-readable name of the editor with which you translate (it does not have to be a dedicated PO editor). This is used in contexts where your editor preference is announced, such as through the <code class="literal">X-Generator</code> PO header field.</p>
</dd>
<dt><span class="term"><code class="literal">[user]/po-editor-id=[lokalize]</code></span></dt>
<dd>
<p>The keyword under which the PO editor that you use is known to Pology. For the moment, only Lokalize is supported. This is used when a Pology tool is told to open PO files on the messages it matched.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="sec-cmcfgenchant" id="sec-cmcfgenchant"></a>9.2.2.&nbsp;The <code class="literal">[enchant]</code> section</h3>
</div>
</div>
</div>
<p>This section configures <a class="ulink" href="http://www.abisource.com/projects/enchant/" target="_top">Enchant</a>, a wrapper library for spell checking, which is used for Pology's <a class="link" href="ch-lingo.html#sec-lgspell" title="8.2.&nbsp;Spell Checking">spell checking functionality</a>. Through Enchant it is possible to use various spell checkers, such as Aspell, Ispell, Hunspell, etc. in a uniform way.</p>
<p>Known configuration fields are as follows:</p>
<div class="variablelist">
<dl>
<dt><span class="term"><code class="literal">[enchant]/provider=[aspell|ispell|myspell|...]</code></span></dt>
<dd>
<p>The keyword denoting the spell checker that Enchant should use. It can also be a comma-separated list of several keywords, when Enchant will use the first available spell checker in the list. You can find the up-to-date list of all known provider keywords in the <span class="command"><strong>enchant(1)</strong></span> man page, and run <span class="command"><strong>enchant-lsmod</strong></span> command to see exactly which of those are recognized as available on the system.</p>
</dd>
<dt><span class="term"><code class="literal">[enchant]/language</code></span></dt>
<dd>
<p>The spell checking dictionary that should be used, by language code. This value is used only if the language is not specified in any other way, such as in the PO header or through command line.</p>
</dd>
<dt><span class="term"><code class="literal">[enchant]/environment</code></span></dt>
<dd>
<p>The sub-language environment for spell checking. This is related to Pology's internal spelling dictionary supplements, see the <a class="link" href="ch-lingo.html#sec-lgspell" title="8.2.&nbsp;Spell Checking">section on spell checking</a>. This value is used only if the environment is not specified in any other way, such as in the PO header or through command line.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="sec-cmcfgaspell" id="sec-cmcfgaspell"></a>9.2.3.&nbsp;The <code class="literal">[aspell]</code> section</h3>
</div>
</div>
</div>
<p>At first Pology used <a class="ulink" href="http://aspell.net/" target="_top">Aspell</a> for spell checking, before Enchant was introduced. Direct support for Aspell was nevertheless kept, due to some specifics that the Enchant wrapper does not support yet. (Which means that you should better use Enchant if it satisfies your needs.)</p>
<p>Known configuration fields are as follows:</p>
<div class="variablelist">
<dl>
<dt><span class="term"><code class="literal">[aspell]/language</code></span></dt>
<dd>
<p>See <code class="literal">[enchant]/language</code>.</p>
</dd>
<dt><span class="term"><code class="literal">[aspell]/encoding</code></span></dt>
<dd>
<p>Encoding for the text sent to Aspell.</p>
</dd>
<dt><span class="term"><code class="literal">[aspell]/variety</code></span></dt>
<dd>
<p>The sub-language variety of the Aspell spelling dictionary.</p>
</dd>
<dt><span class="term"><code class="literal">[aspell]/environment</code></span></dt>
<dd>
<p>See <code class="literal">[enchant]/environment</code>.</p>
</dd>
<dt><span class="term"><code class="literal">[aspell]/supplements-only=[yes|*no]</code></span></dt>
<dd>
<p>Whether to ignore the system spelling dictionary and use only Pology's internal dictionary supplements.</p>
</dd>
<dt><span class="term"><code class="literal">[aspell]/simple-split=[yes|*no]</code></span></dt>
<dd>
<p>By default, Pology splits the text into words in a clever fashion (eliminating text markup, format directives, etc.) before sending them to the spell checker. Sometimes this leads to bad result, and then this field can be set to <code class="literal">yes</code> to split text simply on whitespace (possibly, in the given context, in combination with <a class="link" href="ch-common.html#sec-cmhooks" title="9.10.&nbsp;Processing Hooks">a pre-filtering hook</a> on the text).</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="sec-cmcfgproj" id="sec-cmcfgproj"></a>9.2.4.&nbsp;Per-project sections (<code class="literal">[project-*]</code>)</h3>
</div>
</div>
</div>
<p>You will easily come into the situation where you need to translate and maintain translated material within different projects, each with its own set of rules and conventions. Pology is designed to support project switching extensively, and one element of that are per-project configuration sections.</p>
<p>A project configuration sections has the name <code class="literal">[project-<em class="replaceable"><code>PKEY</code></em>]</code>, where <em class="replaceable"><code>PKEY</code></em> is the project keyword. You can choose the project keyword freely, but it should contain only ASCII letters, digits, underscore and hyphen. Project configuration fields frequently have fallbacks to fields in other configuration sections. This means that when the project field is not set, its corresponding field in that other (more general) section gets used instead. In the following, this is the whenever you are instructed to see a field in another section.</p>
<p>Per-project configuration fields are as follows:</p>
<div class="variablelist">
<dl>
<dt><span class="term"><code class="literal">[project-*]/name</code></span></dt>
<dd>
<p>See <code class="literal">[user]/name</code>.</p>
</dd>
<dt><span class="term"><code class="literal">[project-*]/original-name</code></span></dt>
<dd>
<p>See <code class="literal">[user]/original-name</code>.</p>
</dd>
<dt><span class="term"><code class="literal">[project-*]/email</code></span></dt>
<dd>
<p>See <code class="literal">[user]/email</code>.</p>
</dd>
<dt><span class="term"><code class="literal">[project-*]/language</code></span></dt>
<dd>
<p>See <code class="literal">[user]/language</code>.</p>
</dd>
<dt><span class="term"><code class="literal">[project-*]/language-team</code></span></dt>
<dd>
<p>This is the name of the team which translates this project into given language. Since usually there is only one translation team per language in a project, the value of this field is just the human-readable name of the language (as opposed to language code) in English.</p>
</dd>
<dt><span class="term"><code class="literal">[project-*]/team-email</code></span></dt>
<dd>
<p>The email address for communication with the translation team as whole (usually the team's mailing list).</p>
</dd>
<dt><span class="term"><code class="literal">[project-*]/encoding</code></span></dt>
<dd>
<p>See <code class="literal">[user]/encoding</code>.</p>
</dd>
<dt><span class="term"><code class="literal">[project-*]/plural-forms</code></span></dt>
<dd>
<p>See <code class="literal">[user]/plural-forms</code>.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="sec-cmregex" id="sec-cmregex"></a>9.3.&nbsp;Regular Expressions</h2>
</div>
</div>
</div>
<p>There are great many places in Pology where you can supply a matching pattern, to select or deselect something. This could be a PO file by its path, a PO message by its <code class="varname">msgid</code>, etc. Almost always and by default, this matching pattern will be a <span class="emphasis"><em>regular expression</em></span> (or <span class="emphasis"><em>regex</em></span> for short). Regular expressions are a powerful pattern matching language, a fascinating topic in their own right, and they will serve you well in just about any context of searching on computers. The plain text editor that you use probably offers regular expressions in its search dialog, so does your office text processor, and so on.</p>
<p>Actually, the only point of this brief section is to impress the importance and usefulness of regular expressions onto you, in the case that you have not used them yet. The Internet is full of tutorials on regular expressions, so that there is no point in linking any one particular here.</p>
<p>It should be mentioned that different regular expression engines have somewhat different syntax and expressiveness. Pology uses regular expressions from the Python Standard Library, described here: <a class="ulink" href="http://docs.python.org/library/re.html" target="_top">http://docs.python.org/library/re.html</a> (keep in mind that this page is a reference, and not a tutorial, so you should look elsewhere to learn basics of regular expressions).</p>
</div>
<div class="sect1">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="sec-cmincexc" id="sec-cmincexc"></a>9.4.&nbsp;Path Inclusion and Exclusion</h2>
</div>
</div>
</div>
<p>Pology scripts that can recursively search directory paths for PO files will usually provide several options by which certain files can be included or excluded from processing. The first pair of these options include or exclude files by path:</p>
<div class="variablelist">
<dl>
<dt><span class="term"><code class="option">-E <em class="replaceable"><code>REGEX</code></em></code>, <code class="option">--exclude-path=<em class="replaceable"><code>REGEX</code></em></code></span></dt>
<dd>
<p>Every file with the path that does not match the supplied pattern is excluded from processing. This option can be repeated, when a file is excluded if its path matches <span class="emphasis"><em>every</em></span> pattern. When you want to exclude by <span class="emphasis"><em>any</em></span> pattern matching the path, you can connect those patterns with regular expression <code class="literal">|</code>-operator in a single option. This allows you to build up complex exclusion conditions if necessary.</p>
</dd>
<dt><span class="term"><code class="option">-I <em class="replaceable"><code>REGEX</code></em></code>, <code class="option">--include-path=<em class="replaceable"><code>REGEX</code></em></code></span></dt>
<dd>
<p>Only those files which have the path matching the supplied pattern are included into processing. If the option is repeated, a file is included only if its path matches every pattern.</p>
</dd>
</dl>
</div>
<p>Especially those PO files which are used at runtime (as opposed to those used for <a class="link" href="ch-poformat.html#p-dynstattr">static translation</a>), but others too, are frequently sufficiently identified by their <span class="emphasis"><em>domain</em></span> name. The domain name is the base name of the installed MO file without the extension, e.g. for <code class="filename">/usr/share/locale/sr/LC_MESSAGES/foobar.mo</code> the domain name is <code class="literal">foobar</code>. If, in a given translation project, PO files for a given language are all collected under one top directory of that language, their base names are also formed of domain names.<sup>[<a name="id424751" href="#ftn.id424751" class="footnote" id="id424751">39</a>]</sup> When this is the case, it may be more convenient or safer to match PO files by their domain names instead of paths, which is done by options:</p>
<div class="variablelist">
<dl>
<dt><span class="term"><code class="option">-e <em class="replaceable"><code>REGEX</code></em></code>, <code class="option">--exclude-name=<em class="replaceable"><code>REGEX</code></em></code></span></dt>
<dd>
<p>Counterpart to <code class="option">-E</code>/<code class="option">--exclude-path</code> which matches by domain name.</p>
</dd>
<dt><span class="term"><code class="option">-i <em class="replaceable"><code>REGEX</code></em></code>, <code class="option">--include-name=<em class="replaceable"><code>REGEX</code></em></code></span></dt>
<dd>
<p>Counterpart to <code class="option">-I</code>/<code class="option">--include-path</code> which matches by domain name.</p>
</dd>
</dl>
</div>
<p>All inclusion and exclusion options can be freely mixed and repeated, with consequent resolution. A file is processed if it matches all inclusion patterns (if any is given) and does not match at least one exclusion pattern (if any is given). The other way around, a file is not processed if does not match at least one inclusion pattern (if any is given) or it matches all exclusion patterns (if any is given).</p>
</div>
<div class="sect1">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="sec-cmffrom" id="sec-cmffrom"></a>9.5.&nbsp;Reading Paths From a File</h2>
</div>
</div>
</div>
<p>Sometimes it is convenient to make a temporary or semi-permanent grouping of files, such that the file group can be referenced through a single argument instead of repeating all the files all the time. This is particularly useful when shell piping is not applicable or not comfortable enough. The classic and simple way to group files is by having a file-list file, which contains one file path by line, which a shell command can read to collect files to process.</p>
<p>Many Pology scripts can write and read file-list files. Having scripts write such files automatically is simple enough, just check given script's documentation to see if it has this capability (e.g. the <code class="option">-m</code> option to <span class="command"><strong>posieve</strong></span>). More interesting are the special features that you can use when writing a file-list file manually. You would do this for standing categories which are periodically updated, such as a list of PO files ready for release.</p>
<p>For completeness, here is first an example of a basic file-list file:</p>
<pre class="programlisting">
xray/alpha.po
xray/bravo.po
yankee/charlie.po
yankee/delta.po
</pre>
<p>As is usual for path arguments to Pology scripts, you can specify both file and directory paths, and directory paths will be searched recursively for PO files (or whatever the file type that the script is processing):</p>
<pre class="programlisting">
xray/
yankee/
zulu/echo.po
zulu/foxtrot.po
</pre>
<p>You can add comments by starting the line with hash (<code class="literal">#</code>), and have empty lines:</p>
<pre class="programlisting">
# Translations ready for release.

# Full modules.
xray/
yankee/

# Specific files.
zulu/echo.po
zulu/foxtrot.po
</pre>
<p>The inclusion-exclusion functionality equivalent to <a class="link" href="ch-common.html#sec-cmincexc" title="9.4.&nbsp;Path Inclusion and Exclusion">inclusion-exclusion command line options</a> is provided through inclusion-exclusion directives. They are specified by starting the line with colon (<code class="literal">:</code>), followed by directive type token, followed by a regular expression. The directives are:</p>
<div class="itemizedlist">
<ul class="itemizedlist" type="disc">
<li class="listitem">
<p><code class="literal">:/-<em class="replaceable"><code>REGEX</code></em></code> to exclude files by path,</p>
</li>
<li class="listitem">
<p><code class="literal">:/+<em class="replaceable"><code>REGEX</code></em></code> to include files by path,</p>
</li>
<li class="listitem">
<p><code class="literal">:-<em class="replaceable"><code>REGEX</code></em></code> to exclude files by base name without extension, and</p>
</li>
<li class="listitem">
<p><code class="literal">:+<em class="replaceable"><code>REGEX</code></em></code> to include files by base name without extension.</p>
</li>
</ul>
</div>
<p>For example, if a whole module should be processed but for one PO file in it, it is easier to list the whole module and exclude that one file, as compared to listing all other files:</p>
<pre class="programlisting">
# Modules.
xray/
yankee/
# Exclude november.po (in whichever module it is).
:-november
</pre>
<p>Ordering and position of include-exclude directives is not significant, as they are all applied to all collected files. The semantics of application of multiple directives is the same as that of <a class="link" href="ch-common.html#sec-cmincexc" title="9.4.&nbsp;Path Inclusion and Exclusion">counterpart command line options</a>.</p>
<p>File-list files are normally fed to Pology scripts with the following option:</p>
<div class="variablelist">
<dl>
<dt><span class="term"><code class="option">-f <em class="replaceable"><code>FILE</code></em></code>, <code class="option">--files-from=<em class="replaceable"><code>FILE</code></em></code></span></dt>
<dd>
<p>Read files to process from a file which contains one path per line, or special entries as described above. This option can be repeated to read several file lists. Additional paths to process can still be given as command line arguments. Any inclusion-exclusion options will be applied to the files read from the file as well (in addition to the file's internal inclusion-exclusion directives, if any).</p>
</dd>
</dl>
</div>
</div>
<div class="sect1">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="sec-cmcolors" id="sec-cmcolors"></a>9.6.&nbsp;Output Coloring</h2>
</div>
</div>
</div>
<p>In some contexts, Pology scripts color the terminal output for better visual separation and highlighting of important parts of the text. Examples include warning and error messages, data presented as tables and bars, and, importantly, matched segments of the text in search and validation operations.</p>
<p>Output coloring is turned on by default, but sensitive to output destination: the text is colored if the output is to the terminal (using terminal escape sequences), but not if it is piped to a file. Pology scripts provide the following options by which you can influence this behavior:</p>
<div class="variablelist">
<dl>
<dt><span class="term"><code class="option">-R</code>, <code class="option">--raw-colors</code></span></dt>
<dd>
<p>Disables output destination sensitivity, such that the text is always colored. This is useful when the output is piped to another command which can understand terminal escape sequences by which colors are produce, such as <span class="command"><strong>less(1)</strong></span>. A typical example would be piping search results from <a class="link" href="ch-sieve.html#sv-find-messages" title="3.5.17.&nbsp;find-messages">the <span class="command"><strong>find-messages</strong></span> sieve</a> to be able to scroll them back and forth:</p>
<pre class="programlisting">
$ posieve find-messages ... -R | less -R
</pre>
<p>The <code class="option">-R</code> of <span class="command"><strong>less</strong></span> tells it to interpret escape sequences as colors, rather than showing them as literal text.</p>
</dd>
<dt><span class="term"><code class="option">--coloring-type=[none|term*|html]</code></span></dt>
<dd>
<p>Instead of coloring for the terminal, with this option you can choose another coloring type. <code class="literal">none</code> disables coloring, <code class="literal">term</code> is the default, while <code class="literal">html</code> will produce HTML-tagged text ready for embedding into a web page (e.g. inside a &lt;pre&gt; element). For example, with a little bit of additional scripting, you could use <a class="link" href="ch-sieve.html#sv-stats" title="3.5.30.&nbsp;stats">the <span class="command"><strong>stats</strong></span> sieve</a> and <code class="literal">html</code> coloring to periodically update a web page with translation statistics.</p>
</dd>
</dl>
</div>
</div>
<div class="sect1">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="sec-cminttools" id="sec-cminttools"></a>9.7.&nbsp;Integration with Other Tools</h2>
</div>
</div>
</div>
<p>One of the general aims of Pology is to fit well with other tools typically found in translation workflows based on PO. Although examples of this can be seen throughout the manual, this section gives the overview of integration by the particular supported tool.</p>
<div class="sect2">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="sec-cmsupped" id="sec-cmsupped"></a>9.7.1.&nbsp;PO Editors</h3>
</div>
</div>
</div>
<p>When Pology is used to validate the translation, be it through informal but <a class="link" href="ch-sieve.html#sv-find-messages" title="3.5.17.&nbsp;find-messages">precise searches</a> or formal <a class="link" href="ch-lingo.html#sec-lgrules" title="8.5.&nbsp;Validation Rules">validation rules</a>, those translations found to be invalid must be modified (or possibly a special translator comment added to the message to silence a false positive). Pology will normally always report the PO file path and the location of the message within the file, so that you can get to it in you preferred PO editor. For greater efficiency, however, Pology can directly open the PO files on problematic messages in some PO editors. Currently these are:</p>
<div class="variablelist">
<dl>
<dt><span class="term"><a class="ulink" href="http://userbase.kde.org/Lokalize" target="_top">Lokalize</a></span></dt>
<dd>
<p>Many <a class="link" href="ch-sieve.html" title="Chapter&nbsp;3.&nbsp;Sieving">sieves</a>, notably <span class="command"><strong>find-messages</strong></span>, <span class="command"><strong>check-rules</strong></span>, or <span class="command"><strong>check-spell</strong></span>, provide the parameter <code class="option">lokalize</code> to open PO files on reported messages in Lokalize. This means that when run over a collection of PO files, each PO file with at least one reported message will be loaded into one of Lokalize tabs, and only the reported messages will be shown for editing under each tab. A slight catch is that Lokalize must be manually started before a sieve is run, and the Lokalize project which contains all the sieved PO files must be opened; otherwise, simply nothing will happen.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="sec-cmsuppvcs" id="sec-cmsuppvcs"></a>9.7.2.&nbsp;Version Control Systems</h3>
</div>
</div>
</div>
<p>From the viewpoint of translators, PO files are frequently (though not always) handled in the same way as program code, through version control systems (VCS). Pology defines an abstraction of version control functionality, which enables its tools to transparently cooperate with several VCS. Usually it is necessary to tell a Pology tool which VCS is used, which is done by specifying one of VCS keywords. Currently supported VCS and their keywords are:</p>
<div class="itemizedlist">
<ul class="itemizedlist" type="disc">
<li class="listitem">
<p><a class="ulink" href="http://git-scm.com/" target="_top">Git</a>: <code class="literal">git</code></p>
</li>
<li class="listitem">
<p><a class="ulink" href="http://subversion.tigris.org/" target="_top">Subversion</a>: <code class="literal">svn</code>, <code class="literal">subversion</code></p>
</li>
<li class="listitem">
<p>none (when specifying a VCS is required, but none is actually used): <code class="literal">none</code>, <code class="literal">noop</code></p>
</li>
</ul>
</div>
<p>VCS integration is available in following places:</p>
<div class="itemizedlist">
<ul class="itemizedlist" type="disc">
<li class="listitem">
<p>Producing embedded diffs with <span class="command"><strong>poediff</strong></span> (see <a class="xref" href="ch-diffpatch.html" title="Chapter&nbsp;4.&nbsp;Diffing and Patching">Chapter&nbsp;4, <i>Diffing and Patching</i></a>). Option <code class="option">-c</code>/<code class="option">--vcs</code> can be used to switch <span class="command"><strong>poediff</strong></span> into VCS mode, such that it diffs given paths between repository head and working copy, or between given revisions.</p>
</li>
<li class="listitem">
<p>Translating in summit (see <a class="xref" href="ch-summit.html" title="Chapter&nbsp;5.&nbsp;Summitting Translation Branches">Chapter&nbsp;5, <i>Summitting Translation Branches</i></a>). <span class="command"><strong>posummit</strong></span> will automatically add or remove files from version control as well as to and from disk, so that the modified repository tree can be directly committed after a summit maintenance operation has completed its run.</p>
</li>
<li class="listitem">
<p>Review ascription (see <a class="xref" href="ch-ascript.html" title="Chapter&nbsp;6.&nbsp;Ascribing Modifications and Reviews">Chapter&nbsp;6, <i>Ascribing Modifications and Reviews</i></a>). VCS support is central part of <span class="command"><strong>poascribe</strong></span>, so it will automatically add, remove and commit files to version control as particular ascription operations require.</p>
</li>
</ul>
</div>
<p>Another interesting aspect of VCS support is that, when writing modified PO files to disk, by default Pology will reformat them (almost) only as much as necessary. For example, if only one <code class="varname">msgstr</code> string in the whole PO file has changed, and wrapping is active, only this string and nothing else will be rewrapped when the file is written out. This makes VCS revision deltas smaller and more informative.</p>
</div>
</div>
<div class="sect1">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="sec-cmwrap" id="sec-cmwrap"></a>9.8.&nbsp;Line Wrapping in PO Messages</h2>
</div>
</div>
</div>
<p>While <a class="link" href="ch-poformat.html#sec-powrap" title="2.1.2.&nbsp;String Wrapping">line wrapping of message strings</a> irrelevant to programs that fetch translations from them, it may be significant to the translator, especially when editing the PO file with a plain text editor. Well-wrapped strings make it easier for the translator to follow the text structure, especially in longer messages.</p>
<p>Most Gettext tools (<span class="command"><strong>msgmerge</strong></span>, <span class="command"><strong>msgcat</strong></span>, <span class="command"><strong>msgfilter</strong></span>, etc.) provide options to wrap or not to wrap strings, where wrapping is done on the given column and escaped newlines (<code class="literal">\n</code>). Pology can produce this type of wrapping ("basic" wrapping) as well, but it can also wrap on expected visual line breaks in known text markup, e.g. <code class="literal">&lt;p&gt;</code> and <code class="literal">&lt;br&gt;</code> in HTML ("fine" wrapping). Compare this message in basic wrapping alone:</p>
<pre class="programlisting">
msgid ""
"&lt;p&gt;These settings control the storage of the corrected images. "
"There are four modes to choose from:&lt;/p&gt;&lt;p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;Subfolder:&lt;/"
"b&gt; The corrected images will be saved in a subfolder under the "
"current album path.&lt;/li&gt;&lt;li&gt;&lt;b&gt;Prefix:&lt;/b&gt; A custom prefix will be "
"added to the corrected image.&lt;/li&gt;&lt;li&gt;&lt;b&gt;Suffix:&lt;/b&gt; A custom "
"suffix will be added to the corrected image.&lt;/li&gt;&lt;li&gt;&lt;b&gt;Overwrite:&lt;/"
"b&gt; All original images will be replaced.&lt;/li&gt;&lt;/ul&gt;&lt;/p&gt;&lt;p&gt;Each of "
"the four modes allows you to add an optional keyword to the image "
"metadata.&lt;/p&gt;"
msgstr ""
</pre>
<p>and in basic and fine wrapping together:</p>
<pre class="programlisting">
msgid ""
"&lt;p&gt;These settings control the storage of the corrected images. "
"There are four modes to choose from:&lt;/p&gt;"
"&lt;p&gt;"
"&lt;ul&gt;"
"&lt;li&gt;&lt;b&gt;Subfolder:&lt;/b&gt; The corrected images will be saved in a "
"subfolder under the current album path.&lt;/li&gt;"
"&lt;li&gt;&lt;b&gt;Prefix:&lt;/b&gt; A custom prefix will be added to the corrected "
"image.&lt;/li&gt;"
"&lt;li&gt;&lt;b&gt;Suffix:&lt;/b&gt; A custom suffix will be added to the corrected "
"image.&lt;/li&gt;"
"&lt;li&gt;&lt;b&gt;Overwrite:&lt;/b&gt; All original images will be replaced.&lt;/li&gt;"
"&lt;/ul&gt;"
"&lt;/p&gt;"
"&lt;p&gt;Each of the four modes allows you to add an optional keyword "
"to the image metadata.&lt;/p&gt;"
msgstr ""
</pre>
<p>If you are editing the PO file with a dedicated PO editor, it may itself provide finely tuned wrapping and ignore the wrapping in the PO file, in which case Pology's wrapping facilities are superfluous to you<sup>[<a name="id433800" href="#ftn.id433800" class="footnote" id="id433800">40</a>]</sup>. But a PO editor may also present strings wrapped just as they are in the PO file (and most do!), when Pology's fine wrapping is just as useful as in combination with a plain text editor.</p>
<p>At least for alphabetic languages, the most convenient wrapping may be fine wrapping alone (no basic wrapping), while turning on editor's dynamic (visual) line wrapping. This both makes the text structure easy to follow, and allows editing the translation by logical units (paragraphs, list items) without manually adjusting column breaks or putting up with ugly overlength or mid-broken lines. However, for ideographic languages, editor's dynamic line wrapping may produce bad results, and there basic wrapping might be necessary. In fact, for the moment, for ideographic languages it may be better to pass Pology's wrapping entirely and stick with Gettext's wrapping, since the wrapping algorithm in Gettext is more sophisticated and directly supports ideographic writing systems.</p>
<p>If no wrapping mode is specified when the given PO file is written out, Pology will apply basic wrapping, just as Gettext tools do. There are three general sources from which Pology tools may try to determine the wrapping mode for the given PO file, in decreasing priority: from the command line options, from the PO file's header, and from the user configuration. A tool may or may not provide command line options and configuration fields for wrapping, but PO file headers are always consulted (since this is in Pology's core PO file handling facilities). See the description of <a class="link" href="ch-common.html#hdr-x-wrapping">the <code class="literal">X-Wrapping</code> header field</a> for how to set the wrapping mode in the PO header, and <a class="link" href="ch-sieve.html#sv-set-header" title="3.5.29.&nbsp;set-header">the <code class="literal">set-header</code> sieve</a> for how to set this field in many PO files at once.</p>
<div class="sect2">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="sec-cmwropts" id="sec-cmwropts"></a>9.8.1.&nbsp;Common Command Line Options for Wrapping</h3>
</div>
</div>
</div>
<p>Pology tools in which the wrapping mode can be set from command line, will provide the following options:</p>
<div class="variablelist">
<dl>
<dt><span class="term"><code class="option">--wrap</code></span></dt>
<dd>
<p>Perform basic wrapping, on certain column.</p>
</dd>
<dt><span class="term"><code class="option">--no-wrap</code></span></dt>
<dd>
<p>Do not perform basic wrapping.</p>
</dd>
<dt><span class="term"><code class="option">--fine-wrap</code></span></dt>
<dd>
<p>Perform fine wrapping, on various expected visual breaks introduced by text markup in rendered text.</p>
</dd>
<dt><span class="term"><code class="option">--no-fine-wrap</code></span></dt>
<dd>
<p>Do not perform fine wrapping.</p>
</dd>
<dt><span class="term"><code class="option">--wrap-column=<em class="replaceable"><code>COL</code></em></code></span></dt>
<dd>
<p>The column at which the text should be wrapped. The wrapped line in the PO file will never be longer than this many columns, including the outer quotes. If not given, the default is 79.</p>
</dd>
</dl>
</div>
<p>Both positive and negative wrapping options are provided in order to be able to override the wrapping mode defined by the user configuration of the PO header. As in Gettext tools, strings are always wrapped on <code class="literal">\n</code> regardless of the wrapping mode.</p>
</div>
<div class="sect2">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="sec-cmwrcfg" id="sec-cmwrcfg"></a>9.8.2.&nbsp;Common User Configuration Fields for Wrapping</h3>
</div>
</div>
</div>
<p>The following configuration fields will be read by the tools which consult the user configuration for wrapping mode, in their respective configuration sections:</p>
<div class="variablelist">
<dl>
<dt><span class="term"><code class="literal">[<em class="replaceable"><code>section</code></em>]/wrap=[*yes|no]</code></span></dt>
<dd>
<p>Whether to perform basic wrapping, counterpart to <code class="option">--wrap</code> and <code class="option">--no-wrap</code> command line options.</p>
</dd>
<dt><span class="term"><code class="literal">[<em class="replaceable"><code>section</code></em>]/fine-wrap=[yes|*no]</code></span></dt>
<dd>
<p>Whether to perform fine wrapping, counterpart to <code class="option">--fine-wrap</code> and <code class="option">--no-fine-wrap</code> command line options.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="sec-cmheader" id="sec-cmheader"></a>9.9.&nbsp;Influential Header Fields</h2>
</div>
</div>
</div>
<p><a class="link" href="ch-poformat.html#sec-poheader" title="2.6.&nbsp;PO Header">The PO header</a> is a natural place to provide the information which holds for the PO file as whole. Pology scripts, sieves, and hooks can take into account a number of header fields, when available, to automatically determine some aspects of processing. The fields considered are as follows:</p>
<div class="variablelist">
<dl>
<dt><a name="hdr-language" id="hdr-language"></a><span class="term"><code class="literal">Language</code></span></dt>
<dd>
<p>This field contains the language code of the translation, which Pology will take into account in all contexts where language-dependent processing is done (such as when <a class="link" href="ch-lingo.html#sec-lgspell" title="8.2.&nbsp;Spell Checking">spell-checking</a>). You can also specify the language into which you translate in <a class="link" href="ch-common.html#sec-cmconfig" title="9.2.&nbsp;User Configuration">user configuration</a>, and sometimes in the command line. The language stated by the PO header will override the user configuration, but it will be in turn overridden by the command line. See also <a class="xref" href="ch-lingo.html#sec-lglangenv" title="8.1.&nbsp;The Notion of Language in Pology">Section&nbsp;8.1, “The Notion of Language in Pology”</a>.</p>
</dd>
<dt><a name="hdr-x-accelerator-marker" id="hdr-x-accelerator-marker"></a><span class="term"><code class="literal">X-Accelerator-Marker</code></span></dt>
<dd>
<p><a class="link" href="ch-poformat.html#sec-poaccel" title="2.3.4.&nbsp;Accelerators">Accelerator markers</a> are a frequent obstacle in text processing, such as <a class="link" href="ch-sieve.html#sv-find-messages" title="3.5.17.&nbsp;find-messages">searching</a> or <a class="link" href="ch-lingo.html#sec-lgspell" title="8.2.&nbsp;Spell Checking">spell-checking</a>, because they can split words apart. This field can be used to specify which character is used as accelerator marker throughout the file, if any. If there are several possible characters, they can be given as comma-separated list<sup>[<a name="id427978" href="#ftn.id427978" class="footnote" id="id427978">41</a>]</sup>. While it is usually possible to specify the accelerator marker through the command line, the header field is much more convenient and flexible: there is no need to remember to add the command line option at every run, and different PO files can have different accelerator markers. However, if command line option is issued, it will override the header field.</p>
<p>There is a difference between this field not existing in the header, and existing but with an empty value (i.e. <code class="literal">"X-Accelerator-Marker: \n"</code>). If the field does not exist, some processing elements will go into the "greedy" mode, where they use a list of known frequent accelerator markers (e.g. to remove them from the text). If the field is set to empty value, these processing elements will take it that there are no accelerator markers in text.</p>
</dd>
<dt><a name="hdr-x-associated-ui-catalogs" id="hdr-x-associated-ui-catalogs"></a><span class="term"><code class="literal">X-Associted-UI-Catalogs</code></span></dt>
<dd>
<p>This field lists the PO domains which are the source of user interface references (button labels, menu items, etc.) throughout the text in current PO file. This makes it possible to automatically fetch and insert UI translations, rather than having to look them up manually and maintain them against changes; see <a class="xref" href="ch-lingo.html#sec-lguirefs" title="8.4.&nbsp;Automatic Insertion of UI Labels">Section&nbsp;8.4, “Automatic Insertion of UI Labels”</a> for details. Several PO domains can be given as space- or comma-separated list. If the UI message is found in more than one listed PO domain, the earlier in the list takes precedence.</p>
</dd>
<dt><a name="hdr-x-environment" id="hdr-x-environment"></a><span class="term"><code class="literal">X-Environment</code></span></dt>
<dd>
<p>The language environment to which the translation belongs; see <a class="xref" href="ch-lingo.html#sec-lglangenv" title="8.1.&nbsp;The Notion of Language in Pology">Section&nbsp;8.1, “The Notion of Language in Pology”</a> for details. It can be a single keyword, or a comma-separated list of keywords. If several environments are given, the later in the list (which is usually the more specific) takes precedence.</p>
</dd>
<dt><a name="hdr-x-text-markup" id="hdr-x-text-markup"></a><span class="term"><code class="literal">X-Text-Markup</code></span></dt>
<dd>
<p>When the text contains <a class="link" href="ch-poformat.html#sec-pomarkup" title="2.3.2.&nbsp;Text Markup">markup</a>, it may be useful to remove it such that only the plain text remains. This is the case, for example, when computing word counts or applying <a class="link" href="ch-lingo.html#sec-lgrules" title="8.5.&nbsp;Validation Rules">terminology validation rules</a>. Another use case would be the validation of markup itself (whether a tag is properly closed, whether a tag exists, etc.) This header field specifies the markup type found in the text, as a keyword, so that Pology can determine how to process it. Several markup types can be given as comma-separated list.</p>
<p>Pology currently recognizes the following markup types:</p>
<div class="itemizedlist">
<ul class="itemizedlist" type="disc">
<li class="listitem">
<p><code class="literal">docbook4</code> -- Docbook 4.x markup, in documentation POs</p>
</li>
<li class="listitem">
<p><code class="literal">html</code> -- HTML 4.01</p>
</li>
<li class="listitem">
<p><code class="literal">kde4</code> -- markup in KDE4 UI POs, a mix of Qt rich-text and KUIT</p>
</li>
<li class="listitem">
<p><code class="literal">kuit</code> -- UI semantic markup in KDE 4</p>
</li>
<li class="listitem">
<p><code class="literal">qtrich</code> -- Qt rich-text, (almost) a subset of HTML</p>
</li>
<li class="listitem">
<p><code class="literal">xmlents</code> -- only XML-like entities, no other formal markup</p>
</li>
</ul>
</div>
</dd>
<dt><a name="hdr-x-wrapping" id="hdr-x-wrapping"></a><span class="term"><code class="literal">X-Wrapping</code></span></dt>
<dd>
<p>This header field can be set to tell Pology how to <a class="link" href="ch-common.html#sec-cmwrap" title="9.8.&nbsp;Line Wrapping in PO Messages">wrap strings</a> in the current PO file, for example, when <span class="command"><strong>posieve</strong></span> modifies a message and writes the modified PO file, or when rewrapping is done explicitly by <span class="command"><strong>porewrap</strong></span>. The value is a comma-separated list of wrapping modes, chosen from:</p>
<div class="itemizedlist">
<ul class="itemizedlist" type="disc">
<li class="listitem">
<p><code class="literal">basic</code> -- wrapping on certain column</p>
</li>
<li class="listitem">
<p><code class="literal">fine</code> -- wrapping on logical breaks (such as <code class="literal">&lt;p&gt;</code> or <code class="literal">&lt;br/&gt;</code> tags)</p>
</li>
</ul>
</div>
<p>Wrapping on escaped newline <code class="literal">\n</code> is always performed, regardless of the wrapping mode. If the field value is empty, no other wrapping is done. If more than one wrapping mode is given (e.g. <code class="literal">"X-Wrapping: basic, fine\n"</code>), it is specificaly defined how modes are combined, so the ordering is not important. As usual, if wrapping is specified by a command line option, that will override the header field.</p>
</dd>
</dl>
</div>
<p>All of the listed header fields may be set manually, when you get to work on the particular PO file. But frequently it is possible to set them automatically, or at least automatically for the first time with later manual corrections where needed. For this you may use <a class="link" href="ch-sieve.html#sv-set-header" title="3.5.29.&nbsp;set-header">the <span class="command"><strong>set-header</strong></span> sieve</a>. If PO files are periodically merged by the translation project automation (rather than each translator merging on his own only the PO files which he is about to update), the natural moment to run <span class="command"><strong>set-header</strong></span> is just after the merging. If translation is done <a class="link" href="ch-summit.html" title="Chapter&nbsp;5.&nbsp;Summitting Translation Branches">in summit</a>, you can specify in summit configuration to set header fields on merging.</p>
</div>
<div class="sect1">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="sec-cmhooks" id="sec-cmhooks"></a>9.10.&nbsp;Processing Hooks</h2>
</div>
</div>
</div>
<p>Pology enables the user to insert special processing elements, called <span class="emphasis"><em>hooks</em></span>, at many places in the processing chain. Hooks are Python functions with certain prescribed input, output, and behavior. Depending on the exact combination of these three ingredients, there are various <span class="emphasis"><em>hook types</em></span>. Finally, some hooks can be adapted to a given context through their <span class="emphasis"><em>hook factories</em></span>. Pology defines many hooks internally, and users can add their own external hooks.</p>
<p>Usage of hooks is best illustrated through examples. Suppose that you want to use the <a class="link" href="ch-sieve.html#sv-find-messages" title="3.5.17.&nbsp;find-messages">the <span class="command"><strong>find-messages</strong></span> sieve</a> to look for a certain word, but the text contains XML-like tags of the form <code class="literal">&lt;<em class="replaceable"><code>tagname</code></em>&gt;...&lt;<em class="replaceable"><code>/tagname</code></em>&gt;</code> which happen to be throwing off your search. Suppose that there exists a hook called <code class="literal">remove-xml-tags</code>, in the Pology library module <code class="literal">remove</code>, which takes a piece of text as input and returns that piece of text cleared of any XML-like tags. Then you could insert this hook into the search to clear the tags before matching the text, by using the <code class="option">filter:</code> parameter to <span class="command"><strong>find-messages</strong></span>:</p>
<pre class="programlisting">
$ posieve find-messages -s filter:'remove/remove-xml-tags' ...
</pre>
<p>Here <code class="literal">remove/remove-xml-tags</code> is the hook specification, and this is its usual simplest form: the module name, followed by slash, followed by the hook name. (Sometimes it can be only the module name, when the hook function within that module has the same name as the module, but this is rare.) The hook specification was enclosed in single quotes, for the shell to see it as single string; this was not necessary here, but it is a good habit to keep up when adding hooks through command line, because hook specification can get quite involved.</p>
<p>Suppose now that there is a single hook that can remove any kind of markup from the text (not only XML-like tags) called <code class="literal">remove-markup</code>, but that it has to be told which markup to remove, by giving it one of the markup type keywords known to Pology. Continuing the previous example, this could be done like this:</p>
<pre class="programlisting">
$ posieve find-messages -s filter:'remove/remove-markup~"docbook4"' ...
</pre>
<p>Now the hook specification is <code class="literal">remove/remove-markup~"docbook4"</code>. Note that outer single quotes in the command line are necessary, as otherwise the shell would strip internal double quotes, which are here integral part of hook specification. <code class="literal">remove-markup</code> is actually a <span class="emphasis"><em>hook factory</em></span>, which produces a hook based on the parameters given after the tilde (<code class="literal">~</code>) character. Here <code class="literal">"docbook4"</code> is that parameter; why must it be quoted? Because the part after the tilde is passed as argument list to a Python function, and <code class="literal">"docbook4"</code> must be of string type, which is in Python denoted by quotes. For a hook factory <code class="literal">foo/bar</code> which would take a string and a number, the hook specification would be <code class="literal">foo/bar~"qwyx",5</code>. Sometimes a hook factory has default values for some or all of its arguments; in the latter case, if the defaults are sufficient, the part after the tilde in the hook specification can be left empty (e.g. <code class="literal">foo/bar~</code>).</p>
<p>Hooks can be language- and project-dependent. Suppose that in your language the letters are sometimes accented, but the accents should be ignored on spell-checking. Then Pology may contain a hook which strips accents from text in your language. If your language code is <code class="literal">ll</code>, and the hook is <code class="literal">remove-accents</code> in (language-specific) module <code class="literal">remove</code>, you could check spelling while ignoring accents using the <a class="link" href="ch-sieve.html#sv-find-messages" title="3.5.17.&nbsp;find-messages">the <span class="command"><strong>check-spell-ec</strong></span> sieve</a>:</p>
<pre class="programlisting">
$ posieve check-spell-ec -s filter:'ll:remove/remove-accents' ...
</pre>
<p>The hook specification now also contains the language code separated by colon, as <code class="literal">ll:...</code>. If the hook is project-specific instead, it is prefixed with <code class="literal">pp%...</code>, where <code class="literal">pp</code> is the project identifier and percent sign the separator. If the hook is both language- and project-specific, then the specification is <code class="literal">ll:pp%...</code> or <code class="literal">pp%ll:...</code>.</p>
<div class="sect2">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="sec-cmhooktypes" id="sec-cmhooktypes"></a>9.10.1.&nbsp;Hook Types</h3>
</div>
</div>
</div>
<p>In places where a hook can be inserted, it is convenient to succinctly state which types of hooks are acceptable. Hook types are therefore coded with letter-number-letter combinations. The first letter can be F, V, or S, standing for filtering, validation, or side-effect hook, in that order. Filtering hooks modify their input, validation hooks report problems in input in a way understood by their clients, while side-effect hooks can do anything except modifying the input. The number after the first letter describes the composition of input, which can be pure text, PO message, PO header, etc. and their combinations. The final letter indicates the semantics of the input, like whether the input text is supposed to be the original (<code class="varname">msgid</code>) or the translation (<code class="varname">msgstr</code>) or can be any of them.</p>
<p>The following hooks types are currently defined (the hook type is followed by the expected input in parenthesis):</p>
<div class="variablelist">
<dl>
<dt><span class="term">F1A (text)</span></dt>
<dd>
<p>Modifies the input text.</p>
</dd>
<dt><span class="term">V1A (text)</span></dt>
<dd>
<p>Validates the input text.</p>
</dd>
<dt><span class="term">S1A (text)</span></dt>
<dd>
<p>Side-effects based on the input text.</p>
</dd>
<dt><span class="term">F3A (text, message, file)</span></dt>
<dd>
<p>Modifies the input text, which is one of the strings in the given PO message, which belongs to the given PO file. The difference between F1A and F3A hooks is that an F1A hook can process text based only on the text itself, while an F3A hook can process text by taking into account the information elsewhere in the PO message (e.g. in comments) and the PO file (e.g. in header). This holds for all *1* and *3* hook types.</p>
</dd>
<dt><span class="term">V3A (text, message, file)</span></dt>
<dd>
<p>Validates the input text, which is one of the strings in the given PO message, which belongs to the given PO file.</p>
</dd>
<dt><span class="term">S3A (text, message, file)</span></dt>
<dd>
<p>Side-effects based on the input text, which is one of the strings in the given PO message, which belongs to the given PO file.</p>
</dd>
<dt><span class="term">F3B (original, message, file)</span></dt>
<dd>
<p>Modifies the input text, which is the <code class="varname">msgid</code> (or <code class="varname">msgid_plural</code>) string in the given PO message, which belongs to the given PO file. The difference between F3A and F3B hooks is that the input text of an F3B hook is expected to be precisely the original string in the message, while giving anything else will lead to undefined results. This holds for all *3A, *3B, *3C hook types.</p>
</dd>
<dt><span class="term">V3B (original, message, file)</span></dt>
<dd>
<p>Validates the input text, which is the <code class="varname">msgid</code> (or <code class="varname">msgid_plural</code>) string in the given PO message, which belongs to the given PO file.</p>
</dd>
<dt><span class="term">S3B (original, message, file)</span></dt>
<dd>
<p>Side-effects based on the input text, which is the <code class="varname">msgid</code> (or <code class="varname">msgid_plural</code>) string in the given PO message, which belongs to the given PO file.</p>
</dd>
<dt><span class="term">F3C (translation, message, file)</span></dt>
<dd>
<p>Modifies the input text, which is one of the <code class="varname">msgstr</code> strings in the given PO message, which belongs to the given PO file.</p>
</dd>
<dt><span class="term">V3C (translation, message, file)</span></dt>
<dd>
<p>Validates the input text, which is one of the <code class="varname">msgstr</code> strings in the given PO message, which belongs to the given PO file.</p>
</dd>
<dt><span class="term">S3C (translation, message, file)</span></dt>
<dd>
<p>Side-effects based on the input text, which is one of the <code class="varname">msgstr</code> strings in the given PO message, which belongs to the given PO file.</p>
</dd>
<dt><span class="term">F4A (message, file)</span></dt>
<dd>
<p>Modifies the input PO message, which belongs to the given PO file. The difference between F4A and F3A hooks is that an F3A hook can modify only the given string in the message, while an F4A hook can modify any number of strings, comments, etc. in the message. This holds for all *3* and *4* hook types.</p>
</dd>
<dt><span class="term">V4A (message, file)</span></dt>
<dd>
<p>Validates the input PO message, which belongs to the given PO file.</p>
</dd>
<dt><span class="term">S4A (message, file)</span></dt>
<dd>
<p>Side-effects based on the input PO message, which belongs to the given PO file.</p>
</dd>
<dt><span class="term">F4B (header, file)</span></dt>
<dd>
<p>Modifies the input PO header, which belongs to the given PO file.</p>
</dd>
<dt><span class="term">V4B (header, file)</span></dt>
<dd>
<p>Validates the input PO header, which belongs to the given PO file.</p>
</dd>
<dt><span class="term">S4B (header, file)</span></dt>
<dd>
<p>Side-effects based on the input PO header, which belongs to the given PO file.</p>
</dd>
<dt><span class="term">F5A (file)</span></dt>
<dd>
<p>Modifies the input PO file. As opposed to F1* and F3* hooks, which can modify only elements within PO messages, F5* hooks can also add, remove, and change positions of messages within the PO file.</p>
</dd>
<dt><span class="term">V5A (file)</span></dt>
<dd>
<p>Validates the input PO file. As opposed to V1* and V3* hooks, which report only problems confined to PO messages, V5* hooks can also report problems due to relation between several PO messages each of which is valid in itself.</p>
</dd>
<dt><span class="term">S5A (file)</span></dt>
<dd>
<p>Side-effects based on the input PO file.</p>
</dd>
<dt><span class="term">F6A (any file)</span></dt>
<dd>
<p>Modifies the input file, whether in PO or another format, on the level of pure text lines. This is unlike F5A hooks which operate on the level of entries in the PO file; F6A hooks are also typically limited to certain types of files, perhaps even only PO files. This holds for all *6* hook types.</p>
</dd>
<dt><span class="term">V6A (raw file)</span></dt>
<dd>
<p>Validates the input file.</p>
</dd>
<dt><span class="term">S6A (raw file)</span></dt>
<dd>
<p>Side-effects based on the input file.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="sec-cminthooks" id="sec-cminthooks"></a>9.10.2.&nbsp;List of Internal Hooks</h3>
</div>
</div>
</div>
<p>Pology does not establish strict separation between users and programmers, but presents a continuum between pure use and pure programming, so that users can engage according to their needs and abilities. Hooks, in particular, occupy the middle of this range. On the one hand side, they can be used even from command line; on the other hand side, they are actually Python functions, and hook specifications (in command line and elsewhere) sometimes require Python argument lists (the part after the tilde). This makes it hard both to list all available hooks<sup>[<a name="id437763" href="#ftn.id437763" class="footnote" id="id437763">42</a>]</sup>, and to decide where and how to document them, in the user manual or in the library programming interface (API) documentation. Therefore, the following will be done. Here, in the user manual, only functions written specifically to be used as hooks will be listed (sometimes grouped by similarity), with their types and short descriptions. To that the link to the complete hook description in the API documentation will be added.<sup>[<a name="id437775" href="#ftn.id437775" class="footnote" id="id437775">43</a>]</sup></p>
<div class="sect3">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="sec-cmghooks" id="sec-cmghooks"></a>9.10.2.1.&nbsp;General Hooks</h4>
</div>
</div>
</div>
<div class="variablelist">
<dl>
<dt><a name="hk-bpatterns-bad-patterns" id="hk-bpatterns-bad-patterns"></a><span class="term"><a class="ulink" href="../../api/html/pology.bpatterns-module.html#bad_patterns" target="_top"><code class="literal">bpatterns/bad-patterns</code></a> (S3A),</span> <span class="term"><a class="ulink" href="../../api/html/pology.bpatterns-module.html#bad_patterns_msg" target="_top"><code class="literal">bpatterns/bad-patterns-msg</code></a> (S4A),</span> <span class="term"><a class="ulink" href="../../api/html/pology.bpatterns-module.html#bad_patterns_msg_sp" target="_top"><code class="literal">bpatterns/bad-patterns-msg-sp</code></a> (V4A)</span></dt>
<dd>
<p>Detects unwanted patterns in text, by regular expression matching. Patterns can be specified either as direct arguments, or listed in file given as argument.</p>
<div class="caution" title="Caution" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Caution</h3>
<p>This hook is deprecated. Use <a class="link" href="ch-lingo.html#sec-lgrules" title="8.5.&nbsp;Validation Rules">validation rules</a> instead, which are much a richer method of defining and checking for problems.</p>
</div>
</dd>
<dt><a name="hk-gtxtools-msgfilter" id="hk-gtxtools-msgfilter"></a><span class="term"><a class="ulink" href="../../api/html/pology.gtxtools-module.html#msgfilter" target="_top"><code class="literal">gtxtools/msgfilter</code></a> (F6A)</span></dt>
<dd>
<p>Pipes the PO file through Gettext's <span class="command"><strong>msgfilter(1)</strong></span>. The filter argument and options to <span class="command"><strong>msgfilter</strong></span> can be specified as parameters to hook factory. (May be used to wrap the PO file canonically, as Pology does not produce exactly the same wrapping as Gettext tools.)</p>
</dd>
<dt><a name="hk-gtxtools-msgfmt" id="hk-gtxtools-msgfmt"></a><span class="term"><a class="ulink" href="../../api/html/pology.gtxtools-module.html#msgfmt" target="_top"><code class="literal">gtxtools/msgfmt</code></a> (S6A)</span></dt>
<dd>
<p>Pipes the PO file through Gettext's <span class="command"><strong>msgfmt(1)</strong></span>, discarding output and reporting any errors as warnings. Useful for hard check of the PO file syntax, and extended checks performed when <span class="command"><strong>msgfmt</strong></span> is run with <code class="option">--check</code> option.</p>
</dd>
<dt><a name="hk-markup-check-xml" id="hk-markup-check-xml"></a><span class="term"><a class="ulink" href="../../api/html/pology.markup-module.html#check_xml" target="_top"><code class="literal">markup/check-xml</code></a> (S3C),</span> <span class="term"><a class="ulink" href="../../api/html/pology.markup-module.html#check_xml_sp" target="_top"><code class="literal">markup/check-xml-sp</code></a> (V3C)</span></dt>
<dd>
<p>Checks whether general XML markup in translation is well-formed, and possibly also whether entities are defined. Checks can be performed either only when the original text itself is valid or unconditionally.</p>
</dd>
<dt><a name="hk-markup-check-xml-spec" id="hk-markup-check-xml-spec"></a><span class="term"><a class="ulink" href="../../api/html/pology.markup-module.html#check_docbook4" target="_top"><code class="literal">markup/check-docbook4</code></a> (S3C),</span> <span class="term"><a class="ulink" href="../../api/html/pology.markup-module.html#check_docbook4_sp" target="_top"><code class="literal">markup/check-docbook4-sp</code></a> (V3C),</span> <span class="term"><a class="ulink" href="../../api/html/pology.markup-module.html#check_docbook4_msg" target="_top"><code class="literal">markup/check-docbook4-msg</code></a> (V4A),</span> <span class="term"><a class="ulink" href="../../api/html/pology.markup-module.html#check_html" target="_top"><code class="literal">markup/check-html</code></a> (S3C),</span> <span class="term"><a class="ulink" href="../../api/html/pology.markup-module.html#check_html_sp" target="_top"><code class="literal">markup/check-html-sp</code></a> (V3C),</span> <span class="term"><a class="ulink" href="../../api/html/pology.markup-module.html#check_qtrich" target="_top"><code class="literal">markup/check-qtrich</code></a> (S3C),</span> <span class="term"><a class="ulink" href="../../api/html/pology.markup-module.html#check_qtrich_sp" target="_top"><code class="literal">markup/check-qtrich-sp</code></a> (V3C),</span> <span class="term"><a class="ulink" href="../../api/html/pology.markup-module.html#check_kde4" target="_top"><code class="literal">markup/check-kde4</code></a> (S3C),</span> <span class="term"><a class="ulink" href="../../api/html/pology.markup-module.html#check_kde4_sp" target="_top"><code class="literal">markup/check-kde4-sp</code></a> (V3C),</span> <span class="term"><a class="ulink" href="../../api/html/pology.markup-module.html#check_pango" target="_top"><code class="literal">markup/check-pango</code></a> (S3C),</span> <span class="term"><a class="ulink" href="../../api/html/pology.markup-module.html#check_pango_sp" target="_top"><code class="literal">markup/check-pango-sp</code></a> (V3C)</span></dt>
<dd>
<p>Specializations of <a class="link" href="ch-common.html#hk-markup-check-xml"><code class="literal">markup/check-xml</code></a> hook for various XML formats. Aside from well-formedness, these hooks can also check whether used tags really exist in the format, whether tags are properly nested, etc. (Full conformance to DTD or schema cannot be checked due to chunking into messages.)</p>
</dd>
<dt><a name="hk-markup-check-xmlents" id="hk-markup-check-xmlents"></a><span class="term"><a class="ulink" href="../../api/html/pology.markup-module.html#check_xmlents" target="_top"><code class="literal">markup/check-xmlents</code></a> (S3C),</span> <span class="term"><a class="ulink" href="../../api/html/pology.markup-module.html#check_xmlents_sp" target="_top"><code class="literal">markup/check-xmlents-sp</code></a> (V3C)</span></dt>
<dd>
<p>Checks whether XML-like entities (<code class="literal">&amp;foo;</code>) are defined. This can be used when the markup is not trully XML-like but it uses XML-like entities, or simply to have separate checking of tagging (by <a class="link" href="ch-common.html#hk-markup-check-xml-spec"><code class="literal">markup/check-xml-*</code></a> hooks) and entities for convenience.</p>
</dd>
<dt><a name="hk-noop" id="hk-noop"></a><span class="term"><a class="ulink" href="../../api/html/pology.noop-module.html#text" target="_top"><code class="literal">noop/text</code></a> (F1A),</span> <span class="term"><a class="ulink" href="../../api/html/pology.noop-module.html#textm" target="_top"><code class="literal">noop/textm</code></a> (F3A),</span> <span class="term"><a class="ulink" href="../../api/html/pology.noop-module.html#msg" target="_top"><code class="literal">noop/msg</code></a> (F4A),</span> <span class="term"><a class="ulink" href="../../api/html/pology.noop-module.html#hdr" target="_top"><code class="literal">noop/hdr</code></a> (F4B),</span> <span class="term"><a class="ulink" href="../../api/html/pology.noop-module.html#cat" target="_top"><code class="literal">noop/cat</code></a> (F5A),</span> <span class="term"><a class="ulink" href="../../api/html/pology.noop-module.html#path" target="_top"><code class="literal">noop/path</code></a> (F6A)</span></dt>
<dd>
<p>Filtering hooks that do nothing ("no-operation"). These are useful in contexts where a filtering hook is required, but input should not be really modified.</p>
</dd>
<dt><a name="hk-normalize-demangle-srcrefs" id="hk-normalize-demangle-srcrefs"></a><span class="term"><a class="ulink" href="../../api/html/pology.normalize-module.html#demangle_srcrefs" target="_top"><code class="literal">normalize/demangle-srcrefs</code></a> (F4A)</span></dt>
<dd>
<p>In some message extraction scenarios, the source references end up pointing to dummy files which existed only during the extraction, but true source references can still be reconstructed (based on dummy file names or extracted comments). This hook will reconstruct true source references and replace dummy references with them.</p>
</dd>
<dt><a name="hk-normalize-uniq-source" id="hk-normalize-uniq-source"></a><span class="term"><a class="ulink" href="../../api/html/pology.normalize-module.html#uniq_source" target="_top"><code class="literal">normalize/uniq-source</code></a> (F4A)</span></dt>
<dd>
<p>Sometimes source references in PO message end up doubled (e.g. one prefixed with <code class="filename">./</code> and the other not) due to perculiarities of the extraction process. This hook will make source references unique.</p>
</dd>
<dt><a name="hk-normalize-uniq-auto-comment" id="hk-normalize-uniq-auto-comment"></a><span class="term"><a class="ulink" href="../../api/html/pology.normalize-module.html#uniq_auto_comment" target="_top"><code class="literal">normalize/uniq-auto-comment</code></a> (F4A)</span></dt>
<dd>
<p>When extracted comments are automatically added to messages by the extraction tool, if the message is repeated in several source files it may end up containing multiple equal extracted comments. This hook can be used to make extracted comments unique (either all or those matching some criteria).</p>
</dd>
<dt><a name="hk-normalize-canonical-header" id="hk-normalize-canonical-header"></a><span class="term"><a class="ulink" href="../../api/html/pology.normalize-module.html#canonical_header" target="_top"><code class="literal">normalize/canonical-header</code></a> (F4B)</span></dt>
<dd>
<p>Rearranges content of the PO header into canonical form. For example, translator comments will be sorted according to years of contribution, any repeated translator comments will be merged, etc.</p>
</dd>
<dt><a name="hk-remove-remove-accel" id="hk-remove-remove-accel"></a><span class="term"><a class="ulink" href="../../api/html/pology.remove-module.html#remove_accel_text" target="_top"><code class="literal">remove/remove-accel-text</code></a> (F3A),</span> <span class="term"><a class="ulink" href="../../api/html/pology.remove-module.html#remove_accel_text_greedy" target="_top"><code class="literal">remove/remove-accel-text-greedy</code></a> (F3A),</span> <span class="term"><a class="ulink" href="../../api/html/pology.remove-module.html#remove_accel_msg" target="_top"><code class="literal">remove/remove-accel-msg</code></a> (F4A),</span> <span class="term"><a class="ulink" href="../../api/html/pology.remove-module.html#remove_accel_msg_greedy" target="_top"><code class="literal">remove/remove-accel-msg-greedy</code></a> ()</span></dt>
<dd>
<p>Removes accelerator marker from one or all strings in the message. They will check if the PO file <a class="link" href="ch-common.html#hdr-x-accelerator-marker">specifies the accelerator marker</a>; if not, non-greedy variants will do nothing, while greedy variants will remove everything that is frequently used as accelerator marker.</p>
</dd>
<dt><a name="hk-remove-remove-markup" id="hk-remove-remove-markup"></a><span class="term"><a class="ulink" href="../../api/html/pology.remove-module.html#remove_markup_text" target="_top"><code class="literal">remove/remove-markup-text</code></a> (F3A),</span> <span class="term"><a class="ulink" href="../../api/html/pology.remove-module.html#remove_markup_msg" target="_top"><code class="literal">remove/remove-markup-msg</code></a> (F4A)</span></dt>
<dd>
<p>Converts markup (e.g. XML tags) in one or all strings in the message to plain text. The PO file will be asked for <a class="link" href="ch-common.html#hdr-x-text-markup">the expected markup types in text</a>; if no markup type is specified, these hooks will do nothing.</p>
</dd>
<dt><a name="hk-remove-remove-fmtdirs" id="hk-remove-remove-fmtdirs"></a><span class="term"><a class="ulink" href="../../api/html/pology.remove-module.html#remove_fmtdirs_text" target="_top"><code class="literal">remove/remove-fmtdirs-text</code></a> (F3A),</span> <span class="term"><a class="ulink" href="../../api/html/pology.remove-module.html#remove_fmtdirs_text_tick" target="_top"><code class="literal">remove/remove-fmtdirs-text-tick</code></a> (F3A),</span> <span class="term"><a class="ulink" href="../../api/html/pology.remove-module.html#remove_fmtdirs_msg" target="_top"><code class="literal">remove/remove-fmtdirs-msg</code></a> (F4A),</span> <span class="term"><a class="ulink" href="../../api/html/pology.remove-module.html#remove_fmtdirs_msg_tick" target="_top"><code class="literal">remove/remove-fmtdirs-msg-tick</code></a> (F4A)</span></dt>
<dd>
<p>Removes <a class="link" href="ch-poformat.html#sec-poformdir" title="2.3.1.&nbsp;Format Directives">format directives</a> in one or all strings in the message, or replaces them with a fixed placeholder. The type of format directives is determined by <code class="literal">*-format</code> message flags.</p>
</dd>
<dt><a name="hk-remove-remove-literals" id="hk-remove-remove-literals"></a><span class="term"><a class="ulink" href="../../api/html/pology.remove-module.html#remove_literals_text" target="_top"><code class="literal">remove/remove-literals-text</code></a> (F3A),</span> <span class="term"><a class="ulink" href="../../api/html/pology.remove-module.html#remove_literals_text_tick" target="_top"><code class="literal">remove/remove-literals-text-tick</code></a> (F3A),</span> <span class="term"><a class="ulink" href="../../api/html/pology.remove-module.html#remove_literals_msg" target="_top"><code class="literal">remove/remove-literals-msg</code></a> (F4A),</span> <span class="term"><a class="ulink" href="../../api/html/pology.remove-module.html#remove_literals_msg_tick" target="_top"><code class="literal">remove/remove-literals-msg-tick</code></a> (F4A)</span></dt>
<dd>
<p>Removes "literal" segments from one or all strings in the message, or replaces them wih a fixed placeholder. Literal segments are those which are used as computer input somewhere along the line, such as URLs, email addresses, command line options, etc. and therefore generally do not conform to human language rules. Translator can also explicitly declare literal segments, by adding a special translator comment.</p>
</dd>
<dt><a name="hk-remove-remove-marlits" id="hk-remove-remove-marlits"></a><span class="term"><a class="ulink" href="../../api/html/pology.remove-module.html#remove_marlits_text" target="_top"><code class="literal">remove/remove-marlits-text</code></a> (F3A),</span> <span class="term"><a class="ulink" href="../../api/html/pology.remove-module.html#remove_marlits_msg" target="_top"><code class="literal">remove/remove-marlits-msg</code></a> (F4A)</span></dt>
<dd>
<p><a class="link" href="ch-common.html#hk-remove-remove-literals"><code class="literal">remove/remove-literals-*</code></a> hooks can positively determine only certain types of literals based on the text alone. If the text contains semantic markup, such as Docbook, literal segments can also be determined based on tags, and these hooks will remove both such tags and their text. The markup type will be taken <a class="link" href="ch-common.html#hdr-x-text-markup">from the PO file</a>. (When these hooks are used, <code class="literal">remove/remove-literals-*</code> is not needed.)</p>
</dd>
<dt><a name="hk-remove-rewrite-msgid" id="hk-remove-rewrite-msgid"></a><span class="term"><a class="ulink" href="../../api/html/pology.remove-module.html#rewrite_msgid" target="_top"><code class="literal">remove/rewrite-msgid</code></a> (F4A)</span></dt>
<dd>
<p><a class="link" href="ch-lingo.html#sec-lgrules" title="8.5.&nbsp;Validation Rules">Checks are sometimes defined</a> such that something is first looked up in the original text, and if it is found, something is expected in the translation. No matter how well written these checks are, the original text will sometimes be a bit out of the ordinary, and the check will fail the translation although everything is fine. This can usually be corrected by the translator manually adding a directive, in a special translator comment, to "rewrite" the problematic part of the original before the check is applied.</p>
</dd>
<dt><a name="hk-remove-rewrite-inverse" id="hk-remove-rewrite-inverse"></a><span class="term"><a class="ulink" href="../../api/html/pology.remove-module.html#rewrite_inverse" target="_top"><code class="literal">remove/rewrite-inverse</code></a> (F4A)</span></dt>
<dd>
<p>The original text in the message needs to be modified for the same reasons as described in <a class="link" href="ch-common.html#hk-remove-rewrite-msgid"><code class="literal">remove/rewrite-msgid</code></a>, but it is actually easiest to replace the original text entirely with the original text from another message sharing the same translation (i.e. by "inverse" pairing of messages over translation).</p>
</dd>
<dt><a name="hk-remove-remove-paired-ents" id="hk-remove-remove-paired-ents"></a><span class="term"><a class="ulink" href="../../api/html/pology.remove-module.html#remove_paired_ents" target="_top"><code class="literal">remove/remove-paired-ents</code></a> (F4A)</span></dt>
<dd>
<p>Removes all XML-like entities (<code class="literal">&amp;foo;</code>) from the original text, and all XML-like entities from the translation that were encountered in the original. This may be useful prior to markup validity checks, when the list of defined entities cannot be provided.</p>
</dd>
<dt><a name="hk-spell" id="hk-spell"></a><span class="term"><a class="ulink" href="../../api/html/pology.spell-module.html#check_spell" target="_top"><code class="literal">spell/check-spell</code></a> (S3A),</span> <span class="term"><a class="ulink" href="../../api/html/pology.spell-module.html#check_spell_sp" target="_top"><code class="literal">spell/check-spell-sp</code></a> (V3A)</span></dt>
<dd>
<p>Spell-checking hooks, as one element of <a class="link" href="ch-lingo.html#sec-lgspell" title="8.2.&nbsp;Spell Checking">Pology's spell-checking functionality</a>.</p>
</dd>
<dt><a name="hk-uiref-resolve-ui" id="hk-uiref-resolve-ui"></a><span class="term"><a class="ulink" href="../../api/html/pology.uiref-module.html#resolve_ui" target="_top"><code class="literal">uiref/resolve-ui</code></a> (F3C),</span> <span class="term"><a class="ulink" href="../../api/html/pology.uiref-module.html#resolve_ui_docbook4" target="_top"><code class="literal">uiref/resolve-ui-docbook4</code></a> (F3C),</span> <span class="term"><a class="ulink" href="../../api/html/pology.uiref-module.html#resolve_ui_kde4" target="_top"><code class="literal">uiref/resolve-ui-kde4</code></a> (F3C)</span></dt>
<dd>
<p>When translating program documentation, using these hooks it is possible to leave UI references (button labels, menu items, etc.) untranslated and let them be <a class="link" href="ch-lingo.html#sec-lguirefs" title="8.4.&nbsp;Automatic Insertion of UI Labels">automatically inserted into translation later on</a>. The basic hook requires UI references to be manually wrapped in translation in order to be detected, while specialized versions will also use semantic markup for detection (e.g. <code class="literal">&lt;guilabel&gt;</code> element in Docbook).</p>
</dd>
<dt><a name="hk-uiref-check-ui" id="hk-uiref-check-ui"></a><span class="term"><a class="ulink" href="../../api/html/pology.uiref-module.html#check_ui" target="_top"><code class="literal">uiref/check-ui</code></a> (V3C),</span> <span class="term"><a class="ulink" href="../../api/html/pology.uiref-module.html#check_ui_docbook4" target="_top"><code class="literal">uiref/check-ui-docbook4</code></a> (V3C),</span> <span class="term"><a class="ulink" href="../../api/html/pology.uiref-module.html#check_ui_kde4" target="_top"><code class="literal">uiref/check-ui-kde4</code></a> (V3C)</span></dt>
<dd>
<p>While <a class="link" href="ch-common.html#hk-uiref-resolve-ui"><code class="literal">uiref/resolve-ui</code></a> hooks will complain when they cannot find a translation for a UI reference, when checking the overall validity of translation it is more convenient to use specialized check-only hooks which will not modify the PO file on succesfully resolved UI references.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="sec-cmlshooks" id="sec-cmlshooks"></a>9.10.2.2.&nbsp;Language-Specific Hooks</h4>
</div>
</div>
</div>
<div class="variablelist">
<dl>
<dt><a name="hk-lang-ja-katakana" id="hk-lang-ja-katakana"></a><span class="term"><a class="ulink" href="../../api/html/pology.lang.ja.katakana-module.html#katakana" target="_top"><code class="literal">ja:katakana</code></a> (F1A)</span></dt>
<dd>
<p>Removes everything but Katakana words from Japanese text, and separates retained words with spaces. (Used as filter prior to spell-checking words in Katakana.)</p>
</dd>
<dt><a name="hk-lang-nn-exclusion-inofficial-forms" id="hk-lang-nn-exclusion-inofficial-forms"></a><span class="term"><a class="ulink" href="../../api/html/pology.lang.nn.exclusion-module.html#inofficial_forms" target="_top"><code class="literal">nn:exclusion/inofficial-forms</code></a> (V3C)</span></dt>
<dd>
<p>Checks if there are any inofficial word forms in Norwegian Nynorsk translation.</p>
</dd>
<dt><a name="hk-lang-sr-accents-resolve-agraphs" id="hk-lang-sr-accents-resolve-agraphs"></a><span class="term"><a class="ulink" href="../../api/html/pology.lang.sr.accents-module.html#resolve_agraphs" target="_top"><code class="literal">sr:accents/resolve-agraphs</code></a> (F1A)</span></dt>
<dd>
<p>Converts "accent graphs" to proper accented letters in Serbian Cyrillic text (e.g. <code class="literal">^а</code> becomes <code class="literal">а̂</code>).</p>
</dd>
<dt><a name="hk-lang-sr-accents-remove-accents" id="hk-lang-sr-accents-remove-accents"></a><span class="term"><a class="ulink" href="../../api/html/pology.lang.sr.accents-module.html#remove_accents" target="_top"><code class="literal">sr:accents/remove-accents</code></a> (F1A)</span></dt>
<dd>
<p>Replaces accented letters in Serbian Cyrillic text with their non-accented counterparts. (Useful as filter prior to spell-checking.)</p>
</dd>
<dt><a name="hk-lang-sr-limit-charset" id="hk-lang-sr-limit-charset"></a><span class="term"><a class="ulink" href="../../api/html/pology.lang.sr.charsets-module.html#limit_to_isocyr" target="_top"><code class="literal">sr:charsets/limit-to-isocyr</code></a> (F1A),</span> <span class="term"><a class="ulink" href="../../api/html/pology.lang.sr.charsets-module.html#limit_to_isolat" target="_top"><code class="literal">sr:charsets/limit-to-isolat</code></a> (F1A)</span></dt>
<dd>
<p>In situations where it is necessary to use an 8-bit encoding instead of Unicode for Serbian text, these hooks can be used to constrain characters in text to only those representable by the target 8-bit encoding.</p>
</dd>
<dt><a name="hk-lang-sr-checks-naked-latin" id="hk-lang-sr-checks-naked-latin"></a><span class="term"><a class="ulink" href="../../api/html/pology.lang.sr.checks-module.html#naked_latin" target="_top"><code class="literal">sr:checks/naked-latin</code></a> (V3C),</span> <span class="term"><a class="ulink" href="../../api/html/pology.lang.sr.checks-module.html#naked_latin_origui" target="_top"><code class="literal">sr:checks/naked-latin-origui</code></a> (V3C),</span> <span class="term"><a class="ulink" href="../../api/html/pology.lang.sr.checks-module.html#naked_latin_se" target="_top"><code class="literal">sr:checks/naked-latin-se</code></a> (S3C),</span> <span class="term"><a class="ulink" href="../../api/html/pology.lang.sr.checks-module.html#naked_latin_origui_se" target="_top"><code class="literal">sr:checks/naked-latin-origui-se</code></a> (S3C)</span></dt>
<dd>
<p>In translations into Serbian using Cyrillic script, ordinary segments in Latin script may indicate error or omission in translation. These hooks will look for such stray Latin segments, while ignoring recognizable literal segments such as URLs, commands, options, etc.</p>
</dd>
<dt><a name="hk-lang-sr-nobr-to-nobr-hyphens" id="hk-lang-sr-nobr-to-nobr-hyphens"></a><span class="term"><a class="ulink" href="../../api/html/pology.lang.sr.nobr.to_nobr_hyphens-module.html#" target="_top"><code class="literal">sr:nobr/to-nobr-hyphens</code></a> (F1A)</span></dt>
<dd>
<p>The ordinary hyphen (-) is normally treated as a character on which the text can be split into the next line. In Serbian texts, hyphens are sometimes used to attach case endings to nouns (especially acronyms), which should not be split into the next line. This hooks guesses such positions and replaces the ordinary hyphen with no-break hyphen.</p>
</dd>
<dt><a name="hk-lang-sr-reduce" id="hk-lang-sr-reduce"></a><span class="term"><a class="ulink" href="../../api/html/pology.lang.sr.reduce-module.html#words_ec" target="_top"><code class="literal">sr:reduce/words-ec</code></a> (F1A),</span> <span class="term"><a class="ulink" href="../../api/html/pology.lang.sr.reduce-module.html#words_ec_lw" target="_top"><code class="literal">sr:reduce/words-ec-lw</code></a> (F1A),</span> <span class="term"><a class="ulink" href="../../api/html/pology.lang.sr.reduce-module.html#words_ic" target="_top"><code class="literal">sr:reduce/words-ic</code></a> (F1A),</span> <span class="term"><a class="ulink" href="../../api/html/pology.lang.sr.reduce-module.html#words_ic_lw" target="_top"><code class="literal">sr:reduce/words-ic-lw</code></a> (F1A),</span> <span class="term"><a class="ulink" href="../../api/html/pology.lang.sr.reduce-module.html#words_ic_lw_dlc" target="_top"><code class="literal">sr:reduce/words-ic-lw-dlc</code></a> (F1A)</span></dt>
<dd>
<p>Various reductions of Serbian text to a subset of words of certain type, possibly rearranged in a particular way.</p>
</dd>
<dt><a name="hk-lang-sr-trapres-froments" id="hk-lang-sr-trapres-froments"></a><span class="term"><a class="ulink" href="../../api/html/pology.lang.sr.trapres-module.html#froments" target="_top"><code class="literal">sr:trapres/froments</code></a> (F3C),</span> <span class="term"><a class="ulink" href="../../api/html/pology.lang.sr.trapres-module.html#froments_t1" target="_top"><code class="literal">sr:trapres/froments-t1</code></a> (F3C),</span> <span class="term"><a class="ulink" href="../../api/html/pology.lang.sr.trapres-module.html#froments_t1db" target="_top"><code class="literal">sr:trapres/froments-t1db</code></a> (F3C)</span></dt>
<dd>
<p>Hooks which resolve grammatical inserts in form of XML entities in Serbian text, based on the "trapnakron" contained within Pology. See the documentation in Serbian section for details.</p>
</dd>
<dt><a name="hk-lang-sr-uiref" id="hk-lang-sr-uiref"></a><span class="term"><a class="ulink" href="../../api/html/pology.lang.sr.uiref-module.html#" target="_top"><code class="literal">sr:uiref/mod_entities</code></a> (F1A)</span></dt>
<dd>
<p>When UI references are <a class="link" href="ch-common.html#hk-uiref-resolve-ui">automatically resolved</a> in documentation, and the UI texts may contain <a class="link" href="ch-common.html#hk-lang-sr-trapres-froments">grammatical inserts in form of XML entities</a>, these inserts may need to be slightly modified to keep the documentation structure valid.</p>
</dd>
<dt><a name="hk-lang-sr-wconv" id="hk-lang-sr-wconv"></a><span class="term"><a class="ulink" href="../../api/html/pology.lang.sr.wconv-module.html#ctol" target="_top"><code class="literal">sr:wconv/ctol</code></a> (F1A),</span> <span class="term"><a class="ulink" href="../../api/html/pology.lang.sr.wconv-module.html#cltoa" target="_top"><code class="literal">sr:wconv/cltoa</code></a> (F1A),</span> <span class="term">and many more</span></dt>
<dd>
<p>Hooks for various transliterations and hybridizations of Serbian text, by script (Cyrillic, Latin) and dialect (Ekavian, Ijekavian). See the documentation in Serbian section for details.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="sec-cmpshooks" id="sec-cmpshooks"></a>9.10.2.3.&nbsp;Project-Specific Hooks</h4>
</div>
</div>
</div>
<div class="variablelist">
<dl>
<dt><a name="hk-proj-kde-header-equip-header" id="hk-proj-kde-header-equip-header"></a><span class="term"><a class="ulink" href="../../api/html/pology.proj.kde.header-module.html#equip_header" target="_top"><code class="literal">kde%header/equip-header</code></a> (F4B)</span></dt>
<dd>
<p>Adds assorted header fields to PO files within the KDE Translation Project, with values based on their name and position in the repository tree, so that Pology and other tools are better informed how to process them.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="sec-cmexthooks" id="sec-cmexthooks"></a>9.10.3.&nbsp;Using External Hooks</h3>
</div>
</div>
</div>
<p>[Not implemented yet.]</p>
<p>See <a class="xref" href="ch-prog.html#sec-prhooks" title="11.4.&nbsp;Writing Hooks">Section&nbsp;11.4, “Writing Hooks”</a> for instructions on how to write and contribute hooks.</p>
</div>
</div>
<div class="sect1">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="sec-cmskipcheck" id="sec-cmskipcheck"></a>9.11.&nbsp;Skipping and Selecting Checks</h2>
</div>
</div>
</div>
<p>With all the different heuristic checks and rules that Pology can apply, false positives -- messages proclaimed invalid when they are actually valid -- are inevitable. False positivies are <span class="emphasis"><em>very</em></span> inconvenient in serious automatic quality control effort. They make it harder for translators to spot real problems, which in turn demotivates them to apply automatic checks at all. If there is one or few dedicated persons in the translation team to tweak and apply automatic checks, they would be particularly hard-hit with this negative feedback. False positives can reduce automatic quality control from a strong normative element in the workflow, to merely advisory "run-if-you-have-the-time" extra.</p>
<p>For this reason, most checks in Pology provide a way for them to be disabled on certain messages, files, or the processing batch, such that it is possible to methodically cancel false positives. From the other side, it is usually possible to run one or few checks on their own, in order to be easier to define and debug. Each checking tool and element documents such functionality, and in the following only some general patterns are described.</p>
<p>The simplest method to disable or enable some checks is "dynamically", for single validation run, through an option to the tool which is being run. For example, <a class="link" href="ch-sieve.html#sv-check-rules" title="3.5.7.&nbsp;check-rules">the <span class="command"><strong>check-rules</strong></span> sieve</a> provides several parameters to select and deselect validation rules which are to be applied. The important point here is that checks in Pology usualy have some sort of a unique identifier, a keyword, by which they can be referred to.</p>
<p>"Static" methods to disable or enable checks are those where the instruction is written down somewhere, in a specific format, and automatically taken into account by the validation tool in subsequent runs. There may be several static methods to disable a certain check, differing in their reach: a group of PO files, single PO file, single message, or even a part of the text in the message. Within one PO file, the following methods are common:</p>
<div class="itemizedlist">
<ul class="itemizedlist" type="disc">
<li class="listitem">
<p>The PO header is a natural place to disable or enable checks for the complete PO file, by adding a custom <code class="literal">X-</code> header field.</p>
</li>
<li class="listitem">
<p>On the single message level, the only place where it is possible to add a manual processing instruction is a <a class="link" href="ch-poformat.html#sec-pomancmnt" title="2.2.3.&nbsp;Translator Comments">translator comment</a>. This is because if it would put anywhere else (e.g. as extracted comment or a flag), it would be removed on subsequent merging with template. These instructions are usualy kept simple, like this:</p>
<pre class="programlisting">
# <em class="replaceable"><code>some-instruction</code></em>: <em class="replaceable"><code>arguments</code></em>
#: ...
msgid "..."
msgstr "..."
</pre>
<p>Instructions are always composed of two or more words, separated by hyphens, ended by colon, and followed by an arbitrary argument string (e.g. a list of identifiers of checks to skip on this message). This makes it sufficiently unlikely that another, free-form translator comment will be accidentally interpreted as a known instruction.<sup>[<a name="id411659" href="#ftn.id411659" class="footnote" id="id411659">44</a>]</sup></p>
</li>
<li class="listitem">
<p><a name="p-trflag" id="p-trflag"></a>A special type of translator comment with processing instructions is a comment of the following form:</p>
<pre class="programlisting">
# |, <em class="replaceable"><code>flag1</code></em>, <em class="replaceable"><code>flag2</code></em>, ...
</pre>
<p>This is a "translator flag" comment, which is used to set processing instructions too simple to occupy one whole comment line (e.g. those of the switch type, never needing arguments). It starts with <code class="literal">|,</code>, and continues with comma-separated list of flag-like keywords.</p>
</li>
</ul>
</div>
</div>
<div class="footnotes"><br>
<hr width="100" align="left">
<div class="footnote">
<p><sup>[<a name="ftn.id424751" href="#id424751" class="para" id="ftn.id424751">39</a>]</sup> The other frequently encountered file organization is when there is one directory per PO domain, and that directory contains PO files for all languages, named as <code class="filename"><em class="replaceable"><code>LANG</code></em>.po</code>.</p>
</div>
<div class="footnote">
<p><sup>[<a name="ftn.id433800" href="#id433800" class="para" id="ftn.id433800">40</a>]</sup> But if several people are working on a collection of PO files, it is nevertheless good to agree on fixed wrapping. This is both friendly to those exposed to original wrapping, and to version control systems.</p>
</div>
<div class="footnote">
<p><sup>[<a name="ftn.id427978" href="#id427978" class="para" id="ftn.id427978">41</a>]</sup> This does mean that the case when the comma itself is the accelerator marker is not covered, but this case is beyond unlikely.</p>
</div>
<div class="footnote">
<p><sup>[<a name="ftn.id437763" href="#id437763" class="para" id="ftn.id437763">42</a>]</sup> For example, any Python function in Pology that takes one string and returns the modified version of that string can be considered an F1A hook!</p>
</div>
<div class="footnote">
<p><sup>[<a name="ftn.id437775" href="#id437775" class="para" id="ftn.id437775">43</a>]</sup> In the API documentation, the very first line of the function description will show if the function is a direct hook or a hook factory, the function header will list the inputs for a direct hook (which conform to the declared hook type) or the factory parameters for a hook factory, and the rest of the description will explain the operation of the hook and the meaning of factory parameters.</p>
</div>
<div class="footnote">
<p><sup>[<a name="ftn.id411659" href="#id411659" class="para" id="ftn.id411659">44</a>]</sup> Especially considering that free-form translator comments are more usually written in the language of the translation.</p>
</div>
</div>
</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left"><a accesskey="p" href="ch-lingo.html">Prev</a>&nbsp;</td>
<td width="20%" align="center">&nbsp;</td>
<td width="40%" align="right">&nbsp;<a accesskey="n" href="ch-combined.html">Next</a></td>
</tr>
<tr>
<td width="40%" align="left" valign="top">Chapter&nbsp;8.&nbsp;Language Validation and Derivation&nbsp;</td>
<td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td>
<td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;10.&nbsp;Combined Arms Tactics</td>
</tr>
</table>
</div>
</body>
</html>
