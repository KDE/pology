<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>pology.misc.diff</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="pology-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

      <th class="navbar" width="100%"></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="pology-module.html">Package&nbsp;pology</a> ::
        <a href="pology.misc-module.html">Package&nbsp;misc</a> ::
        Module&nbsp;diff
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
      </table>
    </td>
  </tr>
</table>
<!-- ==================== MODULE DESCRIPTION ==================== -->
<h1 class="epydoc">Module diff</h1><p class="nomargin-top"></p>
<p>Produce special diffs between strings and other interesting 
  objects.</p>

<hr />
<div class="fields">      <p><strong>Author:</strong>
        Chusslove Illich (&#1063;&#1072;&#1089;&#1083;&#1072;&#1074; &#1048;&#1083;&#1080;&#1115;) &lt;caslav.ilic@gmx.net&gt;
      </p>
      <p><strong>License:</strong>
        GPLv3
      </p>
</div><!-- ==================== FUNCTIONS ==================== -->
<a name="section-Functions"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td align="left" colspan="2" class="table-header">
    <span class="table-header">Functions</span></td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">[(string, string)...] or ([(string, string)...], float)</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pology.misc.diff-module.html#word_diff" class="summary-sig-name">word_diff</a>(<span class="summary-sig-arg">text_old</span>,
        <span class="summary-sig-arg">text_new</span>,
        <span class="summary-sig-arg">markup</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">format</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">diffr</span>=<span class="summary-sig-default">False</span>)</span><br />
      Create word-level difference between old and new text.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">string/None or (string/None, float)</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pology.misc.diff-module.html#word_ediff" class="summary-sig-name">word_ediff</a>(<span class="summary-sig-arg">text_old</span>,
        <span class="summary-sig-arg">text_new</span>,
        <span class="summary-sig-arg">markup</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">format</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">hlto</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">diffr</span>=<span class="summary-sig-default">False</span>)</span><br />
      Create word-level embedded difference between old and new texts.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">string or None</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pology.misc.diff-module.html#word_ediff_to_old" class="summary-sig-name">word_ediff_to_old</a>(<span class="summary-sig-arg">dtext</span>)</span><br />
      Recover old version (-) from text with embedded differences.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">string or None</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pology.misc.diff-module.html#word_ediff_to_new" class="summary-sig-name">word_ediff_to_new</a>(<span class="summary-sig-arg">dtext</span>)</span><br />
      Recover new version (+) from text with embedded differences.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">[[(string, string)...]...] or ([([(string, string)...], float)...], 
      float)</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pology.misc.diff-module.html#line_diff" class="summary-sig-name">line_diff</a>(<span class="summary-sig-arg">lines_old</span>,
        <span class="summary-sig-arg">lines_new</span>,
        <span class="summary-sig-arg">markup</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">format</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">diffr</span>=<span class="summary-sig-default">False</span>)</span><br />
      Create word-level difference between old and new lines of text.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">[string...] or ([(string, float)...], float)</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pology.misc.diff-module.html#line_ediff" class="summary-sig-name">line_ediff</a>(<span class="summary-sig-arg">lines_old</span>,
        <span class="summary-sig-arg">lines_new</span>,
        <span class="summary-sig-arg">markup</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">format</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">hlto</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">diffr</span>=<span class="summary-sig-default">False</span>)</span><br />
      Create word-level embedded difference between old and new lines of 
      text.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">list of strings</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pology.misc.diff-module.html#line_ediff_to_old" class="summary-sig-name">line_ediff_to_old</a>(<span class="summary-sig-arg">dlines</span>)</span><br />
      Recover old version (-) from lines of text with embedded differences.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">list of strings</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pology.misc.diff-module.html#line_ediff_to_new" class="summary-sig-name">line_ediff_to_new</a>(<span class="summary-sig-arg">dlines</span>)</span><br />
      Recover new version (+) from lines of text with embedded differences.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">list of index tuples</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pology.misc.diff-module.html#adapt_spans" class="summary-sig-name">adapt_spans</a>(<span class="summary-sig-arg">otext</span>,
        <span class="summary-sig-arg">ftext</span>,
        <span class="summary-sig-arg">spans</span>,
        <span class="summary-sig-arg">merge</span>=<span class="summary-sig-default">True</span>)</span><br />
      Adapt matched spans in filtered text to original text.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">[(string, int/None, [(string, string)...])...] or ([(string, 
      int/None, [(string, string)...], float)...], float)</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pology.misc.diff-module.html#msg_diff" class="summary-sig-name">msg_diff</a>(<span class="summary-sig-arg">msg1</span>,
        <span class="summary-sig-arg">msg2</span>,
        <span class="summary-sig-arg">pfilter</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">addrem</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">diffr</span>=<span class="summary-sig-default">False</span>)</span><br />
      Create word-level difference between extraction-invariant parts of 
      messages.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">type(emsg or msg2 or msg1 or None) or (type(~), float)</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pology.misc.diff-module.html#msg_ediff" class="summary-sig-name">msg_ediff</a>(<span class="summary-sig-arg">msg1</span>,
        <span class="summary-sig-arg">msg2</span>,
        <span class="summary-sig-arg">pfilter</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">addrem</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">emsg</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">ecat</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">emptydc</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">hlto</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">diffr</span>=<span class="summary-sig-default">False</span>)</span><br />
      Create word-level embedded difference between extraction-invariant 
      parts of messages.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">type of first non-None of rmsg, emsg, or None</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pology.misc.diff-module.html#msg_ediff_to_new" class="summary-sig-name">msg_ediff_to_new</a>(<span class="summary-sig-arg">emsg</span>,
        <span class="summary-sig-arg">rmsg</span>=<span class="summary-sig-default">None</span>)</span><br />
      Resolve message with embedded difference to the newer message.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pology.misc.diff-module.html#msg_ediff_to_old" class="summary-sig-name">msg_ediff_to_old</a>(<span class="summary-sig-arg">emsg</span>,
        <span class="summary-sig-arg">rmsg</span>=<span class="summary-sig-default">None</span>)</span><br />
      Resolve message with embedded difference to the older message.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<!-- ==================== VARIABLES ==================== -->
<a name="section-Variables"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td align="left" colspan="2" class="table-header">
    <span class="table-header">Variables</span></td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="x"></a><span class="summary-name">x</span> = <code title="'msgid_plural'"><code class="variable-quote">'</code><code class="variable-string">msgid_plural</code><code class="variable-quote">'</code></code>
    </td>
  </tr>
</table>
<!-- ==================== FUNCTION DETAILS ==================== -->
<a name="section-FunctionDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td align="left" colspan="2" class="table-header">
    <span class="table-header">Function Details</span></td>
</tr>
</table>
<a name="word_diff"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">word_diff</span>(<span class="sig-arg">text_old</span>,
        <span class="sig-arg">text_new</span>,
        <span class="sig-arg">markup</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">format</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">diffr</span>=<span class="sig-default">False</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Create word-level difference between old and new text.</p>
  <p>The difference is computed by looking at texts as collections of words
  and intersegments. Difference is presented as a list of tuples, with each
  tuple composed of a difference tag and a text segment. Difference tag is 
  string <code>&quot;+&quot;</code>, <code>&quot;-&quot;</code>, or 
  <code>&quot; &quot;</code>, for text segments which are new, old, or 
  present in both texts, respectively. If one of the texts is 
  <code>None</code>, as opposed to empty string, a tilde is appended to the
  base difference tag.</p>
  <p>The list is ordered such that joining all text segments not marked as 
  old will reconstruct the new text, and joining all not marked as new will
  reconstruct the old text.</p>
  <p>If requested by the <code>diffr</code> parameter, also reported is the
  <i>difference ratio</i>, a heuristic measure of difference between two 
  texts. 0.0 means no difference, and 1.0 that the texts are completely 
  different.</p>
  <p>Differencing may take into account when the texts are expected to have
  XML-like markup, or when they are of certain format defined by 
  Gettext.</p>
  <p>Examples:</p>
<pre class="literalblock">
   &gt;&gt;&gt; s1 = &quot;A new type of foo.&quot;
   &gt;&gt;&gt; s2 = &quot;A new kind of foo.&quot;
   &gt;&gt;&gt; word_diff(s1, s2)
   [(' ', 'A new '), ('+', 'kind'), ('-', 'type'), (' ', ' of foo.')]
   &gt;&gt;&gt; word_diff(s1, s2, diffr=True)
   ([(' ', 'A new '), ('+', 'kind'), ('-', 'type'), (' ', ' of foo.')],
   0.36363636363636365)
   &gt;&gt;&gt; word_diff(s1, None, diffr=True)
   ([('-~', 'A new type of foo.')], 1.0)
   &gt;&gt;&gt; word_diff(None, s2, diffr=True)
   ([('+~', 'A new kind of foo.')], 1.0)
</pre>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>text_old</code></strong> (string or None) - the old text</li>
        <li><strong class="pname"><code>text_new</code></strong> (string or None) - the new text</li>
        <li><strong class="pname"><code>markup</code></strong> (bool) - whether <code>&lt;...&gt;</code> markup can be expected in the 
          texts</li>
        <li><strong class="pname"><code>format</code></strong> (string) - Gettext format flag (e.g. <code>&quot;c-format&quot;</code>, 
          etc.)</li>
        <li><strong class="pname"><code>diffr</code></strong> (bool) - whether to report difference ratio</li>
    </ul></dd>
    <dt>Returns: [(string, string)...] or ([(string, string)...], float)</dt>
        <dd>difference list and possibly difference ratio</dd>
  </dl>
</td></tr></table>
</div>
<a name="word_ediff"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">word_ediff</span>(<span class="sig-arg">text_old</span>,
        <span class="sig-arg">text_new</span>,
        <span class="sig-arg">markup</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">format</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">hlto</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">diffr</span>=<span class="sig-default">False</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Create word-level embedded difference between old and new texts.</p>
  <p>Same as <a href="pology.misc.diff-module.html#word_diff" 
  class="link">word_diff</a>, but the difference is returned as text in 
  which the new segments are wrapped as <code>{+...+}</code>, and the old 
  segments as <code>{-...-}</code>. If a difference wrapper is already 
  contained in the text, it will be escaped by inserting a tilde, e.g. 
  <code>&quot;{+...+}&quot;</code> -&gt; 
  <code>&quot;{~+...+~}&quot;</code>. If even an escaped wrapper is 
  contained in the text, another tilde is inserted, and so on.</p>
  <p>If one of the texts is <code>None</code>, then the whole other text is
  wrapped as suitable difference, and a tilde added to its end to indicate 
  that the other text was <code>None</code>. If neither of the texts is 
  <code>None</code>, but after differencing the tilde appears in the end of
  embedded difference, it is escaped by another tilde. If both texts are 
  <code>None</code>, <code>None</code> is returned as the difference.</p>
  <p>The <code>hlto</code> parameter can be used to additionally highlight 
  embedded difference for an output descriptor pointed to by it (e.g. 
  colorized for the shell if given as <code>sys.stdout</code>). If 
  highlighting is applied, <a 
  href="pology.misc.diff-module.html#word_ediff_to_old" 
  class="link">word_ediff_to_old</a> and <a 
  href="pology.misc.diff-module.html#word_ediff_to_new" 
  class="link">word_ediff_to_new</a> cannot be used to recover the original
  texts.</p>
  <p>See <a href="pology.misc.diff-module.html#word_diff" 
  class="link">word_diff</a> for description of other parameters.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>hlto</code></strong> (file descriptor) - destination to produce extra highlighting for</li>
    </ul></dd>
    <dt>Returns: string/None or (string/None, float)</dt>
        <dd>string with embedded differences and possibly difference ratio</dd>
  </dl>
<div class="fields">      <p><strong>See Also:</strong>
        <a href="pology.misc.diff-module.html#word_diff" 
        class="link">word_diff</a>
      </p>
</div></td></tr></table>
</div>
<a name="word_ediff_to_old"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">word_ediff_to_old</span>(<span class="sig-arg">dtext</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Recover old version (-) from text with embedded differences.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>dtext</code></strong> (string) - text with embedded differences</li>
    </ul></dd>
    <dt>Returns: string or None</dt>
        <dd>old version of the text</dd>
  </dl>
<div class="fields">      <p><strong>See Also:</strong>
        <a href="pology.misc.diff-module.html#word_ediff" 
        class="link">word_ediff</a>
      </p>
</div></td></tr></table>
</div>
<a name="word_ediff_to_new"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">word_ediff_to_new</span>(<span class="sig-arg">dtext</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Recover new version (+) from text with embedded differences.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>dtext</code></strong> (string) - text with embedded differences</li>
    </ul></dd>
    <dt>Returns: string or None</dt>
        <dd>new version of the text</dd>
  </dl>
<div class="fields">      <p><strong>See Also:</strong>
        <a href="pology.misc.diff-module.html#word_ediff" 
        class="link">word_ediff</a>
      </p>
</div></td></tr></table>
</div>
<a name="line_diff"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">line_diff</span>(<span class="sig-arg">lines_old</span>,
        <span class="sig-arg">lines_new</span>,
        <span class="sig-arg">markup</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">format</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">diffr</span>=<span class="sig-default">False</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Create word-level difference between old and new lines of text.</p>
  <p>First makes a difference on a line-level, and then for each set of 
  differing lines a difference on word-level, using <a 
  href="pology.misc.diff-module.html#word_diff" class="link">word_diff</a>.
  Difference is presented as a list of tuples of word diffs and ratios as 
  constructed by <a href="pology.misc.diff-module.html#word_diff" 
  class="link">word_diff</a>. See <a 
  href="pology.misc.diff-module.html#word_diff" class="link">word_diff</a> 
  for description of keyword parameters. The difference ratio is computed 
  as line-length weighted average of word difference ratios per line.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>lines_old</code></strong> (string) - old lines of text</li>
        <li><strong class="pname"><code>lines_new</code></strong> (string) - new lines of text</li>
    </ul></dd>
    <dt>Returns: [[(string, string)...]...] or ([([(string, string)...], float)...], 
      float)</dt>
        <dd>difference list and possibly difference ratios</dd>
  </dl>
</td></tr></table>
</div>
<a name="line_ediff"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">line_ediff</span>(<span class="sig-arg">lines_old</span>,
        <span class="sig-arg">lines_new</span>,
        <span class="sig-arg">markup</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">format</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">hlto</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">diffr</span>=<span class="sig-default">False</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Create word-level embedded difference between old and new lines of 
  text.</p>
  <p>Same as <a href="pology.misc.diff-module.html#line_diff" 
  class="link">line_diff</a>, but the difference is returned as list of 
  tuples of line of text (in which the new segments are wrapped as 
  <code>{+...+}</code>, and the old segments as <code>{-...-}</code>) and 
  difference ratio for the line. See <a 
  href="pology.misc.diff-module.html#word_diff" class="link">word_diff</a> 
  and <a href="pology.misc.diff-module.html#word_ediff" 
  class="link">word_ediff</a> for description of keyword parameters.</p>
  <dl class="fields">
    <dt>Returns: [string...] or ([(string, float)...], float)</dt>
        <dd>lines with embedded differences and possibly difference ratios</dd>
  </dl>
<div class="fields">      <p><strong>See Also:</strong>
        <a href="pology.misc.diff-module.html#line_diff" 
        class="link">line_diff</a>
      </p>
</div></td></tr></table>
</div>
<a name="line_ediff_to_old"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">line_ediff_to_old</span>(<span class="sig-arg">dlines</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Recover old version (-) from lines of text with embedded 
  differences.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>dlines</code></strong> (list of strings) - lines of text with embedded differences</li>
    </ul></dd>
    <dt>Returns: list of strings</dt>
        <dd>old version of the lines</dd>
  </dl>
<div class="fields">      <p><strong>See Also:</strong>
        <a href="pology.misc.diff-module.html#line_ediff" 
        class="link">line_ediff</a>
      </p>
</div></td></tr></table>
</div>
<a name="line_ediff_to_new"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">line_ediff_to_new</span>(<span class="sig-arg">dlines</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Recover new version (+) from lines of text with embedded 
  differences.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>dlines</code></strong> (list of strings) - lines of text with embedded differences</li>
    </ul></dd>
    <dt>Returns: list of strings</dt>
        <dd>new version of the lines</dd>
  </dl>
<div class="fields">      <p><strong>See Also:</strong>
        <a href="pology.misc.diff-module.html#line_ediff" 
        class="link">line_ediff</a>
      </p>
</div></td></tr></table>
</div>
<a name="adapt_spans"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">adapt_spans</span>(<span class="sig-arg">otext</span>,
        <span class="sig-arg">ftext</span>,
        <span class="sig-arg">spans</span>,
        <span class="sig-arg">merge</span>=<span class="sig-default">True</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Adapt matched spans in filtered text to original text.</p>
  <p>Sometimes text gets filtered before being matched, and when a match is
  found in the filtered text, it needs to be reported relative to the 
  original text. This function will heuristically adapt matched spans 
  relative to the filtered text back to the original text.</p>
  <p>Spans are given as list of index tuples <code>[(start1, end1), 
  ...]</code> where start and end index have standard Python semantics (may
  be negative too). If <code>merge</code> is <code>True</code>, any spans 
  that overlap or abut after adaptation will be merged into a single span, 
  ordered by increasing start index, and empty spans removed; otherwise 
  each adapted span will strictly correspond to the input span at that 
  position.</p>
  <p>Span tuples may have more elements past the start and end indices. 
  They will be ignored, but preserved; if merging is in effect, extra 
  elements will be preserved for only the frontmost of the overlapping 
  spans (undefined for which if there are several).</p>
  <p>If any of the input spans are invalid, the results are undefined.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>otext</code></strong> (string) - original text</li>
        <li><strong class="pname"><code>ftext</code></strong> (string) - filtered text</li>
        <li><strong class="pname"><code>spans</code></strong> (list of index tuples) - matched spans</li>
        <li><strong class="pname"><code>merge</code></strong> (bool) - whether to merge overlapping spans</li>
    </ul></dd>
    <dt>Returns: list of index tuples</dt>
        <dd>adapted spans</dd>
  </dl>
</td></tr></table>
</div>
<a name="msg_diff"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">msg_diff</span>(<span class="sig-arg">msg1</span>,
        <span class="sig-arg">msg2</span>,
        <span class="sig-arg">pfilter</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">addrem</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">diffr</span>=<span class="sig-default">False</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Create word-level difference between extraction-invariant parts of 
  messages.</p>
  <p>For which parts of a message are considered extraction-invariant, see 
  description of <a href="pology.file.message.Message_base-class.html" 
  class="link">inv</a> instance variable of message objects.</p>
  <p>There are two return modes, depending on the value of 
  <code>diffr</code> parameter.</p>
  <p>If <code>diffr</code> is <code>False</code>, the difference is 
  returned as list of 3-tuples of differences by message part: (part name, 
  part item, word difference). The part name can be used to fetch the part 
  value from the message, using <a 
  href="pology.file.message.Message_base-class.html#get" 
  class="link">get()</a> method of message objects. The part item is 
  <code>None</code> for singular message parts (e.g. <code>msgid</code>), 
  and index for list parts (e.g. <code>msgstr</code>). See <a 
  href="pology.misc.diff-module.html#word_diff" class="link">word_diff</a> 
  for the format of word-level difference.</p>
  <p>If <code>diffr</code> is <code>True</code>, then each part difference 
  has a fourth element, the difference ratio; see <a 
  href="pology.misc.diff-module.html#word_diff" class="link">word_diff</a> 
  for its semantics. Additionally, the total difference ratio is computed, 
  based on partial ones (also counting the zero difference of parts which 
  were equal). The return value is now a 2-tuple of list of part 
  differences (as 4-tuples) and the total difference ratio.</p>
  <p>Either of the messages can be given as <code>None</code>. In case only
  one of the messages is <code>None</code>, the difference of 
  <code>msgid</code> field will show that this field does not exist in the 
  non-existant message (according to format of non-existant counterparts of
  <a href="pology.misc.diff-module.html#word_diff" 
  class="link">word_diff</a>). If both messages are <code>None</code>, the 
  difference is empty list, as the messages are same, even if 
  non-existant.</p>
  <p>Every <code>msgstr</code> field can be passed through a filter before 
  differencing, using the <code>pfilter</code> parameter.</p>
  <p>Instead of constructing the full difference, using the 
  <code>addrem</code> parameter only equal, added, or removed segments can 
  be reported. The value of this parameter is a string, such that the first
  character selects the type of partial difference: one of ('=', &quot;e') 
  for equal, ('+', 'a') for added, and ('-', 'r') for removed segments, and
  the rest of the string is used as separator to join the selected segments
  (if the separator is empty, space is used instead).</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>msg1</code></strong> (<a href="pology.file.message.Message_base-class.html" 
          class="link">Message_base</a> or None) - the message from which to make the difference</li>
        <li><strong class="pname"><code>msg2</code></strong> (<a href="pology.file.message.Message_base-class.html" 
          class="link">Message_base</a> or None) - the message to which to make the difference</li>
        <li><strong class="pname"><code>pfilter</code></strong> (callable) - filter to be applied to translation prior to differencing</li>
        <li><strong class="pname"><code>addrem</code></strong> (string) - report equal, added or removed segments instead of full 
          difference, joined by what follows the selection character</li>
        <li><strong class="pname"><code>diffr</code></strong> (bool) - whether to report difference ratio</li>
    </ul></dd>
    <dt>Returns: [(string, int/None, [(string, string)...])...] or ([(string, 
      int/None, [(string, string)...], float)...], float)</dt>
        <dd>difference list</dd>
  </dl>
</td></tr></table>
</div>
<a name="msg_ediff"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">msg_ediff</span>(<span class="sig-arg">msg1</span>,
        <span class="sig-arg">msg2</span>,
        <span class="sig-arg">pfilter</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">addrem</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">emsg</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">ecat</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">emptydc</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">hlto</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">diffr</span>=<span class="sig-default">False</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Create word-level embedded difference between extraction-invariant 
  parts of messages.</p>
  <p>Like <a href="pology.misc.diff-module.html#msg_diff" 
  class="link">msg_diff</a>, but instead of difference list the result is a
  message with embedded differences, of the kind produced by <a 
  href="pology.misc.diff-module.html#word_ediff" 
  class="link">word_ediff</a>. See <a 
  href="pology.misc.diff-module.html#msg_diff" class="link">msg_diff</a> 
  for description <code>pfilter</code> and <code>addrem</code> parameters, 
  and <a href="pology.misc.diff-module.html#word_ediff" 
  class="link">word_ediff</a> for the format of embedded differences. 
  Additionally, if <code>pfilter</code> is given, <code>msgstr</code> 
  fields will be diffed both with and without the filter, and both 
  embeddings are going to be presented in the field, suitably visually 
  separated.</p>
  <p>By default, a new message with embedded difference will be 
  constructed, of the type of first non-None of <code>msg2</code> and 
  <code>msg1</code>. Alternatively, the difference can be embedded into the
  message supplied by <code>emsg</code> parameter.</p>
  <p>If resulting messages with embedded differences are to be inserted 
  into a catalog, that catalog can be given by the <code>ecat</code> 
  parameter. Then, if the key of the resulting message would conflict one 
  of those already in the catalog, its context will be appropriately padded
  to avoid the conflict. This is done by adding a pipe character and an 
  unspecified number of alphanumerics (generally junk-looking) to the end 
  of the <code>msgctxt</code>.</p>
  <p>An additional automatic comment starting with <code>x-ediff:</code> 
  may be added to the message, possibly followed by some indicators 
  necessary to complete the difference specification. These include:</p>
  <ul>
    <li>
      <code>state &lt;STATE_DIFF&gt; ...</code>: changes in message state, 
      like <code>obsolete</code> and <code>fuzzy</code>; e.g. <code>state 
      {+obsolete+}</code> means that the message has been obsoleted from 
      <code>msg1</code> to <code>msg2</code>, while <code>state 
      {-obsolete-}</code> means that it has been was revived.
    </li>
    <li>
      <code>ctxtpad &lt;STRING&gt;</code>: padding alphanumerics added to 
      the <code>msgctxt</code> field to avoid key collision with one of the
      messages from <code>ecat</code>.
    </li>
    <li>
      <code>fseplen &lt;NUMBER&gt;</code>: if {pfilter} was used, and the 
      default field separator had to be extended because such substring 
      already existed in the text, this indicator states its length.
    </li>
  </ul>
  <p>By default the difference comment is not added if there are no 
  indicators, but it may be forced by setting <code>emptydc</code> 
  parameter to <code>True</code>.</p>
  <p>Embedded differences can be additionally highlighted for an output 
  descriptor given by <code>hlto</code> parameter (e.g. colorized for the 
  shell).</p>
  <p>If <code>diffr</code> is <code>True</code>, aside from the message 
  with embedded differences, the total difference ratio is returned (see <a
  href="pology.misc.diff-module.html#msg_diff" class="link">msg_diff</a>). 
  If <code>pfilter</code> is given, the ratio refers to difference under 
  filter.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>msg1</code></strong> (<a href="pology.file.message.Message_base-class.html" 
          class="link">Message_base</a> or None) - the message from which to make the difference</li>
        <li><strong class="pname"><code>msg2</code></strong> (<a href="pology.file.message.Message_base-class.html" 
          class="link">Message_base</a> or None) - the message to which to make the difference</li>
        <li><strong class="pname"><code>pfilter</code></strong> (callable) - filter to be applied to translation prior to differencing</li>
        <li><strong class="pname"><code>addrem</code></strong> (string) - report equal, added or removed segments instead of full 
          difference, joined by what follows the selection character</li>
        <li><strong class="pname"><code>emsg</code></strong> (<a href="pology.file.message.Message_base-class.html" 
          class="link">Message_base</a>) - message to embedd the difference to</li>
        <li><strong class="pname"><code>ecat</code></strong> (<a href="pology.file.catalog.Catalog-class.html" 
          class="link">Catalog</a>) - catalog of messages to avoid key conflict with</li>
        <li><strong class="pname"><code>emptydc</code></strong> (bool) - whether to add difference comment even if empty</li>
        <li><strong class="pname"><code>hlto</code></strong> (file) - destination to produce highlighting for</li>
        <li><strong class="pname"><code>diffr</code></strong> (bool) - whether to report difference ratio</li>
    </ul></dd>
    <dt>Returns: type(emsg or msg2 or msg1 or None) or (type(~), float)</dt>
        <dd>message with embedded differences (or None) and possibly 
          difference ratio</dd>
  </dl>
</td></tr></table>
</div>
<a name="msg_ediff_to_new"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">msg_ediff_to_new</span>(<span class="sig-arg">emsg</span>,
        <span class="sig-arg">rmsg</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Resolve message with embedded difference to the newer message.</p>
  <p>Message cannot be properly resolved if <code>hlto</code> or 
  <code>addrem</code> parameters to <a 
  href="pology.misc.diff-module.html#msg_ediff" class="link">msg_ediff</a> 
  were used on embedding. In this function is called on such a message, the
  result is undefined.</p>
  <p>By default a new message object is created, but using the 
  <code>rmsg</code> parameter, en existing message can be given to be 
  filled with all the resolved parts (keeping its own, ignored parts). This
  message can be the <code>emsg</code> itself.</p>
  <p>If the resolved message evaluates to no message, the function returns 
  <code>None</code>, and <code>rmsg</code> is not touched if it was 
  given.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>emsg</code></strong> (<a href="pology.file.message.Message_base-class.html" 
          class="link">Message_base</a> or None) - resolvable message with embedded differences</li>
        <li><strong class="pname"><code>rmsg</code></strong> (<a href="pology.file.message.Message_base-class.html" 
          class="link">Message_base</a>) - message to fill in the resolved parts</li>
    </ul></dd>
    <dt>Returns: type of first non-None of rmsg, emsg, or None</dt>
        <dd>resolved message (or None)</dd>
  </dl>
</td></tr></table>
</div>
<a name="msg_ediff_to_old"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">msg_ediff_to_old</span>(<span class="sig-arg">emsg</span>,
        <span class="sig-arg">rmsg</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Resolve message with embedded difference to the older message.</p>
  <p>Like <a href="pology.misc.diff-module.html#msg_ediff_to_new" 
  class="link">msg_ediff_to_new</a>, only constructing the opposite 
  message. See <a href="pology.misc.diff-module.html#msg_ediff_to_new" 
  class="link">msg_ediff_to_new</a> for parameters and return values.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="pology-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

      <th class="navbar" width="100%"></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
